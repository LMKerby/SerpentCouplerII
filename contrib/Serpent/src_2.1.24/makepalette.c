/*****************************************************************************/
/*                                                                           */
/* serpent 2 (beta-version) : makepalette.c                                  */
/*                                                                           */
/* Created:       2011/03/27 (JLe)                                           */
/* Last modified: 2014/12/12 (JLe)                                           */
/* Version:       2.1.23                                                     */
/*                                                                           */
/* Description: Creates palette for mesh plots                               */
/*                                                                           */
/* Comments:                                                                 */
/*                                                                           */
/*****************************************************************************/

#include "header.h"
#include "locations.h"

#define FUNCTION_NAME "MakePalette:"

void MakePalette(long *r, long *g, long *b, long colors, long type)
{
  long n;
  double f1, f2, x0, x1;

  /* Check type */

  if (type == PALETTE_HOT)
    {
      /***********************************************************************/

      /***** Hot color palette ***********************************************/

      /* Loop over colors */

      for (n = 0; n < colors; n++)
	{
	  /* Linear factor */

	  f1 = ((double)n)/((double)colors - 1.0);
	  
	  /* Red */
	  
	  x0 = 0.00;
	  x1 = 1.00;
	  
	  if (f1 < x0)
	    f2 = 0.0;
	  else if (f1 > x1)
	    f2 = 1.0;
	  else
	    f2 = (f1 - x0)/(x1 - x0);
	  
	  /* Sin factor */

	  f2 = sin(0.5*PI*f2);

	  /* Color value */

	  r[n] = (long)(235.0*f2) + 20;
	  
	  /* Green */
	  
	  x0 = 0.33;
	  x1 = 1.00;
	  
	  if (f1 < x0)
	    f2 = 0.0;
	  else if (f1 > x1)
	    f2 = 1.0;
	  else
	    f2 = (f1 - x0)/(x1 - x0);
	  
	  /* Sin factor */

	  f2 = sin(0.5*PI*f2);
	  
	  /* Color value */

	  g[n] = (long)(255.0*f2);
	  
	  /* Blue */
	  
	  x0 = 0.66;
	  x1 = 1.00;
	  
	  if (f1 < x0)
	    f2 = 0.0;
	  else if (f1 > x1)
	    f2 = 1.0;
	  else
	    f2 = (f1 - x0)/(x1 - x0);
	  
	  /* Sin factor */

	  f2 = sin(0.5*PI*f2);
	  
	  /* Color value */

	  b[n] = (long)(255.0*f2);
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_COLD)
    {
      /***********************************************************************/

      /***** Cold color palette **********************************************/

      /* Loop over colors */

      for (n = 0; n < colors; n++)
	{
	  /* Linear factor */

	  f1 = ((double)n)/((double)colors - 1.0);
	  
	  /* Red */
	  
	  x0 = 0.66;
	  x1 = 1.00;
	  
	  if (f1 < x0)
	    f2 = 0.0;
	  else if (f1 > x1)
	    f2 = 1.0;
	  else
	    f2 = (f1 - x0)/(x1 - x0);
	  
	  /* Sin factor */

	  f2 = sin(0.5*PI*f2);
	  
	  /* Color value */

	  r[n] = (long)(255.0*f2);

	  /* Green */
	  
	  x0 = 0.33;
	  x1 = 1.00;
	  
	  if (f1 < x0)
	    f2 = 0.0;
	  else if (f1 > x1)
	    f2 = 1.0;
	  else
	    f2 = (f1 - x0)/(x1 - x0);
	  
	  /* Sin factor */

	  f2 = sin(0.5*PI*f2);
	  
	  /* Color value */

	  g[n] = (long)(255.0*f2);

	  /* Blue */
	  
	  x0 = 0.00;
	  x1 = 1.00;
	  
	  if (f1 < x0)
	    f2 = 0.0;
	  else if (f1 > x1)
	    f2 = 1.0;
	  else
	    f2 = (f1 - x0)/(x1 - x0);
	  
	  /* Sin factor */

	  f2 = sin(0.5*PI*f2);

	  /* Color value */

 	  b[n] = (long)(235.0*f2) + 20;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_GREEN_PURPLE)
    {
      /***********************************************************************/

      /***** Green-purple palette ********************************************/

      if (colors == 256)
	{
	  r[  0] =  77; g[  0] = 146; b[  0] =  33;
	  r[  1] =  79; g[  1] = 148; b[  1] =  34;
	  r[  2] =  81; g[  2] = 150; b[  2] =  36;
	  r[  3] =  83; g[  3] = 152; b[  3] =  37;
	  r[  4] =  86; g[  4] = 154; b[  4] =  39;
	  r[  5] =  88; g[  5] = 156; b[  5] =  40;
	  r[  6] =  90; g[  6] = 158; b[  6] =  42;
	  r[  7] =  92; g[  7] = 160; b[  7] =  43;
	  r[  8] =  94; g[  8] = 162; b[  8] =  45;
	  r[  9] =  96; g[  9] = 164; b[  9] =  46;
	  r[ 10] =  98; g[ 10] = 166; b[ 10] =  48;
	  r[ 11] = 100; g[ 11] = 168; b[ 11] =  49;
	  r[ 12] = 102; g[ 12] = 170; b[ 12] =  51;
	  r[ 13] = 104; g[ 13] = 172; b[ 13] =  52;
	  r[ 14] = 106; g[ 14] = 174; b[ 14] =  54;
	  r[ 15] = 108; g[ 15] = 175; b[ 15] =  56;
	  r[ 16] = 110; g[ 16] = 177; b[ 16] =  57;
	  r[ 17] = 112; g[ 17] = 179; b[ 17] =  59;
	  r[ 18] = 114; g[ 18] = 181; b[ 18] =  61;
	  r[ 19] = 116; g[ 19] = 183; b[ 19] =  62;
	  r[ 20] = 118; g[ 20] = 184; b[ 20] =  64;
	  r[ 21] = 120; g[ 21] = 186; b[ 21] =  66;
	  r[ 22] = 122; g[ 22] = 188; b[ 22] =  67;
	  r[ 23] = 124; g[ 23] = 189; b[ 23] =  69;
	  r[ 24] = 126; g[ 24] = 191; b[ 24] =  71;
	  r[ 25] = 128; g[ 25] = 192; b[ 25] =  73;
	  r[ 26] = 130; g[ 26] = 194; b[ 26] =  75;
	  r[ 27] = 132; g[ 27] = 195; b[ 27] =  76;
	  r[ 28] = 134; g[ 28] = 197; b[ 28] =  78;
	  r[ 29] = 136; g[ 29] = 198; b[ 29] =  80;
	  r[ 30] = 138; g[ 30] = 200; b[ 30] =  82;
	  r[ 31] = 140; g[ 31] = 201; b[ 31] =  84;
	  r[ 32] = 142; g[ 32] = 203; b[ 32] =  86;
	  r[ 33] = 144; g[ 33] = 204; b[ 33] =  87;
	  r[ 34] = 145; g[ 34] = 205; b[ 34] =  89;
	  r[ 35] = 147; g[ 35] = 207; b[ 35] =  91;
	  r[ 36] = 149; g[ 36] = 208; b[ 36] =  93;
	  r[ 37] = 151; g[ 37] = 209; b[ 37] =  95;
	  r[ 38] = 153; g[ 38] = 210; b[ 38] =  97;
	  r[ 39] = 155; g[ 39] = 211; b[ 39] =  99;
	  r[ 40] = 157; g[ 40] = 212; b[ 40] = 101;
	  r[ 41] = 158; g[ 41] = 213; b[ 41] = 103;
	  r[ 42] = 160; g[ 42] = 215; b[ 42] = 105;
	  r[ 43] = 162; g[ 43] = 215; b[ 43] = 107;
	  r[ 44] = 164; g[ 44] = 216; b[ 44] = 109;
	  r[ 45] = 166; g[ 45] = 217; b[ 45] = 111;
	  r[ 46] = 167; g[ 46] = 218; b[ 46] = 114;
	  r[ 47] = 169; g[ 47] = 219; b[ 47] = 116;
	  r[ 48] = 171; g[ 48] = 220; b[ 48] = 118;
	  r[ 49] = 173; g[ 49] = 221; b[ 49] = 121;
	  r[ 50] = 175; g[ 50] = 222; b[ 50] = 123;
	  r[ 51] = 177; g[ 51] = 223; b[ 51] = 126;
	  r[ 52] = 179; g[ 52] = 224; b[ 52] = 128;
	  r[ 53] = 181; g[ 53] = 225; b[ 53] = 131;
	  r[ 54] = 183; g[ 54] = 226; b[ 54] = 134;
	  r[ 55] = 185; g[ 55] = 227; b[ 55] = 136;
	  r[ 56] = 187; g[ 56] = 228; b[ 56] = 139;
	  r[ 57] = 189; g[ 57] = 229; b[ 57] = 142;
	  r[ 58] = 191; g[ 58] = 230; b[ 58] = 145;
	  r[ 59] = 193; g[ 59] = 231; b[ 59] = 147;
	  r[ 60] = 195; g[ 60] = 232; b[ 60] = 150;
	  r[ 61] = 196; g[ 61] = 233; b[ 61] = 153;
	  r[ 62] = 198; g[ 62] = 233; b[ 62] = 156;
	  r[ 63] = 200; g[ 63] = 234; b[ 63] = 159;
	  r[ 64] = 202; g[ 64] = 235; b[ 64] = 161;
	  r[ 65] = 204; g[ 65] = 236; b[ 65] = 164;
	  r[ 66] = 206; g[ 66] = 236; b[ 66] = 167;
	  r[ 67] = 207; g[ 67] = 237; b[ 67] = 169;
	  r[ 68] = 209; g[ 68] = 238; b[ 68] = 172;
	  r[ 69] = 211; g[ 69] = 239; b[ 69] = 175;
	  r[ 70] = 212; g[ 70] = 239; b[ 70] = 177;
	  r[ 71] = 214; g[ 71] = 240; b[ 71] = 180;
	  r[ 72] = 215; g[ 72] = 240; b[ 72] = 182;
	  r[ 73] = 217; g[ 73] = 241; b[ 73] = 185;
	  r[ 74] = 218; g[ 74] = 242; b[ 74] = 187;
	  r[ 75] = 220; g[ 75] = 242; b[ 75] = 190;
	  r[ 76] = 221; g[ 76] = 243; b[ 76] = 192;
	  r[ 77] = 222; g[ 77] = 243; b[ 77] = 194;
	  r[ 78] = 224; g[ 78] = 243; b[ 78] = 196;
	  r[ 79] = 225; g[ 79] = 244; b[ 79] = 198;
	  r[ 80] = 226; g[ 80] = 244; b[ 80] = 200;
	  r[ 81] = 227; g[ 81] = 244; b[ 81] = 202;
	  r[ 82] = 228; g[ 82] = 245; b[ 82] = 204;
	  r[ 83] = 229; g[ 83] = 245; b[ 83] = 205;
	  r[ 84] = 229; g[ 84] = 245; b[ 84] = 207;
	  r[ 85] = 230; g[ 85] = 245; b[ 85] = 208;
	  r[ 86] = 231; g[ 86] = 245; b[ 86] = 209;
	  r[ 87] = 231; g[ 87] = 245; b[ 87] = 211;
	  r[ 88] = 232; g[ 88] = 245; b[ 88] = 212;
	  r[ 89] = 232; g[ 89] = 245; b[ 89] = 213;
	  r[ 90] = 233; g[ 90] = 245; b[ 90] = 215;
	  r[ 91] = 234; g[ 91] = 245; b[ 91] = 216;
	  r[ 92] = 234; g[ 92] = 246; b[ 92] = 217;
	  r[ 93] = 235; g[ 93] = 246; b[ 93] = 219;
	  r[ 94] = 235; g[ 94] = 246; b[ 94] = 220;
	  r[ 95] = 236; g[ 95] = 246; b[ 95] = 221;
	  r[ 96] = 236; g[ 96] = 246; b[ 96] = 223;
	  r[ 97] = 237; g[ 97] = 246; b[ 97] = 224;
	  r[ 98] = 237; g[ 98] = 246; b[ 98] = 225;
	  r[ 99] = 238; g[ 99] = 246; b[ 99] = 226;
	  r[100] = 238; g[100] = 246; b[100] = 227;
	  r[101] = 239; g[101] = 246; b[101] = 229;
	  r[102] = 239; g[102] = 246; b[102] = 230;
	  r[103] = 239; g[103] = 246; b[103] = 231;
	  r[104] = 240; g[104] = 246; b[104] = 232;
	  r[105] = 240; g[105] = 246; b[105] = 233;
	  r[106] = 241; g[106] = 246; b[106] = 234;
	  r[107] = 241; g[107] = 247; b[107] = 235;
	  r[108] = 241; g[108] = 247; b[108] = 236;
	  r[109] = 242; g[109] = 247; b[109] = 237;
	  r[110] = 242; g[110] = 247; b[110] = 238;
	  r[111] = 243; g[111] = 247; b[111] = 239;
	  r[112] = 243; g[112] = 247; b[112] = 240;
	  r[113] = 243; g[113] = 247; b[113] = 241;
	  r[114] = 244; g[114] = 247; b[114] = 242;
	  r[115] = 244; g[115] = 247; b[115] = 242;
	  r[116] = 244; g[116] = 247; b[116] = 243;
	  r[117] = 244; g[117] = 247; b[117] = 244;
	  r[118] = 245; g[118] = 247; b[118] = 244;
	  r[119] = 245; g[119] = 247; b[119] = 245;
	  r[120] = 245; g[120] = 247; b[120] = 245;
	  r[121] = 245; g[121] = 247; b[121] = 246;
	  r[122] = 246; g[122] = 247; b[122] = 246;
	  r[123] = 246; g[123] = 247; b[123] = 246;
	  r[124] = 246; g[124] = 247; b[124] = 247;
	  r[125] = 246; g[125] = 247; b[125] = 247;
	  r[126] = 247; g[126] = 247; b[126] = 247;
	  r[127] = 247; g[127] = 247; b[127] = 247;
	  r[128] = 247; g[128] = 247; b[128] = 247;
	  r[129] = 247; g[129] = 247; b[129] = 247;
	  r[130] = 248; g[130] = 247; b[130] = 247;
	  r[131] = 248; g[131] = 247; b[131] = 247;
	  r[132] = 248; g[132] = 247; b[132] = 247;
	  r[133] = 248; g[133] = 246; b[133] = 247;
	  r[134] = 248; g[134] = 246; b[134] = 247;
	  r[135] = 249; g[135] = 246; b[135] = 247;
	  r[136] = 249; g[136] = 246; b[136] = 247;
	  r[137] = 249; g[137] = 245; b[137] = 246;
	  r[138] = 249; g[138] = 245; b[138] = 246;
	  r[139] = 249; g[139] = 245; b[139] = 246;
	  r[140] = 250; g[140] = 244; b[140] = 246;
	  r[141] = 250; g[141] = 244; b[141] = 246;
	  r[142] = 250; g[142] = 243; b[142] = 246;
	  r[143] = 250; g[143] = 243; b[143] = 246;
	  r[144] = 250; g[144] = 242; b[144] = 246;
	  r[145] = 250; g[145] = 242; b[145] = 245;
	  r[146] = 251; g[146] = 241; b[146] = 245;
	  r[147] = 251; g[147] = 241; b[147] = 245;
	  r[148] = 251; g[148] = 240; b[148] = 245;
	  r[149] = 251; g[149] = 240; b[149] = 245;
	  r[150] = 251; g[150] = 239; b[150] = 244;
	  r[151] = 251; g[151] = 238; b[151] = 244;
	  r[152] = 252; g[152] = 238; b[152] = 244;
	  r[153] = 252; g[153] = 237; b[153] = 244;
	  r[154] = 252; g[154] = 236; b[154] = 243;
	  r[155] = 252; g[155] = 236; b[155] = 243;
	  r[156] = 252; g[156] = 235; b[156] = 243;
	  r[157] = 252; g[157] = 234; b[157] = 243;
	  r[158] = 252; g[158] = 233; b[158] = 242;
	  r[159] = 252; g[159] = 233; b[159] = 242;
	  r[160] = 253; g[160] = 232; b[160] = 242;
	  r[161] = 253; g[161] = 231; b[161] = 242;
	  r[162] = 253; g[162] = 230; b[162] = 241;
	  r[163] = 253; g[163] = 230; b[163] = 241;
	  r[164] = 253; g[164] = 229; b[164] = 241;
	  r[165] = 253; g[165] = 228; b[165] = 241;
	  r[166] = 253; g[166] = 227; b[166] = 240;
	  r[167] = 253; g[167] = 226; b[167] = 240;
	  r[168] = 253; g[168] = 226; b[168] = 240;
	  r[169] = 253; g[169] = 225; b[169] = 239;
	  r[170] = 253; g[170] = 224; b[170] = 239;
	  r[171] = 253; g[171] = 223; b[171] = 239;
	  r[172] = 253; g[172] = 222; b[172] = 238;
	  r[173] = 253; g[173] = 221; b[173] = 238;
	  r[174] = 253; g[174] = 221; b[174] = 237;
	  r[175] = 253; g[175] = 220; b[175] = 237;
	  r[176] = 252; g[176] = 219; b[176] = 236;
	  r[177] = 252; g[177] = 218; b[177] = 236;
	  r[178] = 252; g[178] = 217; b[178] = 235;
	  r[179] = 252; g[179] = 216; b[179] = 235;
	  r[180] = 251; g[180] = 214; b[180] = 234;
	  r[181] = 251; g[181] = 213; b[181] = 233;
	  r[182] = 251; g[182] = 212; b[182] = 233;
	  r[183] = 250; g[183] = 211; b[183] = 232;
	  r[184] = 250; g[184] = 210; b[184] = 231;
	  r[185] = 249; g[185] = 208; b[185] = 230;
	  r[186] = 249; g[186] = 207; b[186] = 229;
	  r[187] = 248; g[187] = 206; b[187] = 229;
	  r[188] = 248; g[188] = 204; b[188] = 228;
	  r[189] = 247; g[189] = 203; b[189] = 227;
	  r[190] = 247; g[190] = 202; b[190] = 226;
	  r[191] = 246; g[191] = 200; b[191] = 225;
	  r[192] = 246; g[192] = 199; b[192] = 224;
	  r[193] = 245; g[193] = 197; b[193] = 223;
	  r[194] = 245; g[194] = 196; b[194] = 222;
	  r[195] = 244; g[195] = 194; b[195] = 221;
	  r[196] = 243; g[196] = 193; b[196] = 220;
	  r[197] = 243; g[197] = 191; b[197] = 219;
	  r[198] = 242; g[198] = 189; b[198] = 218;
	  r[199] = 242; g[199] = 188; b[199] = 217;
	  r[200] = 241; g[200] = 186; b[200] = 216;
	  r[201] = 240; g[201] = 184; b[201] = 214;
	  r[202] = 240; g[202] = 183; b[202] = 213;
	  r[203] = 239; g[203] = 181; b[203] = 212;
	  r[204] = 238; g[204] = 179; b[204] = 211;
	  r[205] = 238; g[205] = 177; b[205] = 210;
	  r[206] = 237; g[206] = 175; b[206] = 209;
	  r[207] = 236; g[207] = 174; b[207] = 208;
	  r[208] = 236; g[208] = 172; b[208] = 206;
	  r[209] = 235; g[209] = 170; b[209] = 205;
	  r[210] = 235; g[210] = 168; b[210] = 204;
	  r[211] = 234; g[211] = 166; b[211] = 203;
	  r[212] = 233; g[212] = 164; b[212] = 202;
	  r[213] = 233; g[213] = 162; b[213] = 200;
	  r[214] = 232; g[214] = 160; b[214] = 199;
	  r[215] = 231; g[215] = 158; b[215] = 198;
	  r[216] = 231; g[216] = 156; b[216] = 197;
	  r[217] = 230; g[217] = 153; b[217] = 195;
	  r[218] = 229; g[218] = 151; b[218] = 194;
	  r[219] = 229; g[219] = 149; b[219] = 193;
	  r[220] = 228; g[220] = 146; b[220] = 191;
	  r[221] = 227; g[221] = 144; b[221] = 190;
	  r[222] = 227; g[222] = 141; b[222] = 188;
	  r[223] = 226; g[223] = 138; b[223] = 187;
	  r[224] = 225; g[224] = 136; b[224] = 185;
	  r[225] = 224; g[225] = 133; b[225] = 184;
	  r[226] = 224; g[226] = 130; b[226] = 182;
	  r[227] = 223; g[227] = 127; b[227] = 180;
	  r[228] = 222; g[228] = 124; b[228] = 179;
	  r[229] = 221; g[229] = 121; b[229] = 177;
	  r[230] = 220; g[230] = 118; b[230] = 175;
	  r[231] = 220; g[231] = 115; b[231] = 173;
	  r[232] = 219; g[232] = 112; b[232] = 172;
	  r[233] = 218; g[233] = 109; b[233] = 170;
	  r[234] = 217; g[234] = 105; b[234] = 168;
	  r[235] = 216; g[235] = 102; b[235] = 166;
	  r[236] = 215; g[236] =  99; b[236] = 164;
	  r[237] = 214; g[237] =  95; b[237] = 162;
	  r[238] = 214; g[238] =  92; b[238] = 161;
	  r[239] = 213; g[239] =  88; b[239] = 159;
	  r[240] = 212; g[240] =  85; b[240] = 157;
	  r[241] = 211; g[241] =  81; b[241] = 155;
	  r[242] = 210; g[242] =  77; b[242] = 153;
	  r[243] = 209; g[243] =  74; b[243] = 151;
	  r[244] = 208; g[244] =  70; b[244] = 149;
	  r[245] = 207; g[245] =  66; b[245] = 147;
	  r[246] = 206; g[246] =  63; b[246] = 144;
	  r[247] = 205; g[247] =  59; b[247] = 142;
	  r[248] = 204; g[248] =  55; b[248] = 140;
	  r[249] = 203; g[249] =  51; b[249] = 138;
	  r[250] = 202; g[250] =  47; b[250] = 136;
	  r[251] = 201; g[251] =  43; b[251] = 134;
	  r[252] = 200; g[252] =  39; b[252] = 132;
	  r[253] = 199; g[253] =  35; b[253] = 129;
	  r[254] = 198; g[254] =  31; b[254] = 127;
	  r[255] = 197; g[255] =  27; b[255] = 125;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_PURPLE_ORANGE)
    {
      /***********************************************************************/

      /***** Purple-orange palette *******************************************/

      if (colors == 256)
	{
	  r[  0] =  84; g[  0] =  39; b[  0] = 136;
	  r[  1] =  86; g[  1] =  42; b[  1] = 138;
	  r[  2] =  87; g[  2] =  44; b[  2] = 139;
	  r[  3] =  89; g[  3] =  47; b[  3] = 141;
	  r[  4] =  91; g[  4] =  50; b[  4] = 142;
	  r[  5] =  92; g[  5] =  53; b[  5] = 144;
	  r[  6] =  94; g[  6] =  55; b[  6] = 146;
	  r[  7] =  96; g[  7] =  58; b[  7] = 147;
	  r[  8] =  97; g[  8] =  61; b[  8] = 149;
	  r[  9] =  99; g[  9] =  63; b[  9] = 150;
	  r[ 10] = 101; g[ 10] =  66; b[ 10] = 152;
	  r[ 11] = 102; g[ 11] =  68; b[ 11] = 153;
	  r[ 12] = 104; g[ 12] =  71; b[ 12] = 155;
	  r[ 13] = 106; g[ 13] =  74; b[ 13] = 156;
	  r[ 14] = 107; g[ 14] =  76; b[ 14] = 158;
	  r[ 15] = 109; g[ 15] =  79; b[ 15] = 159;
	  r[ 16] = 111; g[ 16] =  81; b[ 16] = 161;
	  r[ 17] = 112; g[ 17] =  84; b[ 17] = 162;
	  r[ 18] = 114; g[ 18] =  86; b[ 18] = 163;
	  r[ 19] = 116; g[ 19] =  89; b[ 19] = 165;
	  r[ 20] = 117; g[ 20] =  91; b[ 20] = 166;
	  r[ 21] = 119; g[ 21] =  94; b[ 21] = 168;
	  r[ 22] = 120; g[ 22] =  96; b[ 22] = 169;
	  r[ 23] = 122; g[ 23] =  98; b[ 23] = 171;
	  r[ 24] = 124; g[ 24] = 101; b[ 24] = 172;
	  r[ 25] = 125; g[ 25] = 103; b[ 25] = 173;
	  r[ 26] = 127; g[ 26] = 106; b[ 26] = 175;
	  r[ 27] = 129; g[ 27] = 108; b[ 27] = 176;
	  r[ 28] = 130; g[ 28] = 110; b[ 28] = 177;
	  r[ 29] = 132; g[ 29] = 113; b[ 29] = 179;
	  r[ 30] = 133; g[ 30] = 115; b[ 30] = 180;
	  r[ 31] = 135; g[ 31] = 117; b[ 31] = 181;
	  r[ 32] = 137; g[ 32] = 119; b[ 32] = 182;
	  r[ 33] = 138; g[ 33] = 122; b[ 33] = 184;
	  r[ 34] = 140; g[ 34] = 124; b[ 34] = 185;
	  r[ 35] = 141; g[ 35] = 126; b[ 35] = 186;
	  r[ 36] = 143; g[ 36] = 128; b[ 36] = 187;
	  r[ 37] = 144; g[ 37] = 130; b[ 37] = 189;
	  r[ 38] = 146; g[ 38] = 133; b[ 38] = 190;
	  r[ 39] = 148; g[ 39] = 135; b[ 39] = 191;
	  r[ 40] = 149; g[ 40] = 137; b[ 40] = 192;
	  r[ 41] = 151; g[ 41] = 139; b[ 41] = 193;
	  r[ 42] = 152; g[ 42] = 141; b[ 42] = 194;
	  r[ 43] = 154; g[ 43] = 143; b[ 43] = 196;
	  r[ 44] = 155; g[ 44] = 145; b[ 44] = 197;
	  r[ 45] = 157; g[ 45] = 147; b[ 45] = 198;
	  r[ 46] = 159; g[ 46] = 149; b[ 46] = 199;
	  r[ 47] = 160; g[ 47] = 151; b[ 47] = 200;
	  r[ 48] = 162; g[ 48] = 153; b[ 48] = 201;
	  r[ 49] = 163; g[ 49] = 156; b[ 49] = 202;
	  r[ 50] = 165; g[ 50] = 158; b[ 50] = 204;
	  r[ 51] = 167; g[ 51] = 160; b[ 51] = 205;
	  r[ 52] = 168; g[ 52] = 162; b[ 52] = 206;
	  r[ 53] = 170; g[ 53] = 164; b[ 53] = 207;
	  r[ 54] = 172; g[ 54] = 166; b[ 54] = 208;
	  r[ 55] = 173; g[ 55] = 168; b[ 55] = 209;
	  r[ 56] = 175; g[ 56] = 170; b[ 56] = 210;
	  r[ 57] = 177; g[ 57] = 172; b[ 57] = 211;
	  r[ 58] = 178; g[ 58] = 174; b[ 58] = 213;
	  r[ 59] = 180; g[ 59] = 176; b[ 59] = 214;
	  r[ 60] = 181; g[ 60] = 178; b[ 60] = 215;
	  r[ 61] = 183; g[ 61] = 180; b[ 61] = 216;
	  r[ 62] = 185; g[ 62] = 182; b[ 62] = 217;
	  r[ 63] = 186; g[ 63] = 184; b[ 63] = 218;
	  r[ 64] = 188; g[ 64] = 186; b[ 64] = 219;
	  r[ 65] = 190; g[ 65] = 188; b[ 65] = 220;
	  r[ 66] = 191; g[ 66] = 190; b[ 66] = 221;
	  r[ 67] = 193; g[ 67] = 192; b[ 67] = 222;
	  r[ 68] = 194; g[ 68] = 194; b[ 68] = 223;
	  r[ 69] = 196; g[ 69] = 195; b[ 69] = 224;
	  r[ 70] = 197; g[ 70] = 197; b[ 70] = 225;
	  r[ 71] = 199; g[ 71] = 199; b[ 71] = 226;
	  r[ 72] = 200; g[ 72] = 201; b[ 72] = 226;
	  r[ 73] = 201; g[ 73] = 202; b[ 73] = 227;
	  r[ 74] = 203; g[ 74] = 204; b[ 74] = 228;
	  r[ 75] = 204; g[ 75] = 205; b[ 75] = 229;
	  r[ 76] = 206; g[ 76] = 207; b[ 76] = 230;
	  r[ 77] = 207; g[ 77] = 208; b[ 77] = 230;
	  r[ 78] = 208; g[ 78] = 210; b[ 78] = 231;
	  r[ 79] = 209; g[ 79] = 211; b[ 79] = 232;
	  r[ 80] = 211; g[ 80] = 212; b[ 80] = 232;
	  r[ 81] = 212; g[ 81] = 214; b[ 81] = 233;
	  r[ 82] = 213; g[ 82] = 215; b[ 82] = 234;
	  r[ 83] = 214; g[ 83] = 216; b[ 83] = 234;
	  r[ 84] = 215; g[ 84] = 217; b[ 84] = 235;
	  r[ 85] = 216; g[ 85] = 218; b[ 85] = 235;
	  r[ 86] = 217; g[ 86] = 219; b[ 86] = 235;
	  r[ 87] = 218; g[ 87] = 220; b[ 87] = 236;
	  r[ 88] = 219; g[ 88] = 221; b[ 88] = 236;
	  r[ 89] = 220; g[ 89] = 222; b[ 89] = 237;
	  r[ 90] = 221; g[ 90] = 223; b[ 90] = 237;
	  r[ 91] = 222; g[ 91] = 224; b[ 91] = 238;
	  r[ 92] = 223; g[ 92] = 225; b[ 92] = 238;
	  r[ 93] = 224; g[ 93] = 226; b[ 93] = 238;
	  r[ 94] = 225; g[ 94] = 227; b[ 94] = 239;
	  r[ 95] = 226; g[ 95] = 228; b[ 95] = 239;
	  r[ 96] = 226; g[ 96] = 229; b[ 96] = 240;
	  r[ 97] = 227; g[ 97] = 230; b[ 97] = 240;
	  r[ 98] = 228; g[ 98] = 231; b[ 98] = 240;
	  r[ 99] = 229; g[ 99] = 232; b[ 99] = 241;
	  r[100] = 230; g[100] = 232; b[100] = 241;
	  r[101] = 231; g[101] = 233; b[101] = 242;
	  r[102] = 232; g[102] = 234; b[102] = 242;
	  r[103] = 233; g[103] = 235; b[103] = 242;
	  r[104] = 233; g[104] = 236; b[104] = 243;
	  r[105] = 234; g[105] = 237; b[105] = 243;
	  r[106] = 235; g[106] = 238; b[106] = 243;
	  r[107] = 236; g[107] = 238; b[107] = 244;
	  r[108] = 237; g[108] = 239; b[108] = 244;
	  r[109] = 237; g[109] = 240; b[109] = 244;
	  r[110] = 238; g[110] = 240; b[110] = 244;
	  r[111] = 239; g[111] = 241; b[111] = 245;
	  r[112] = 239; g[112] = 242; b[112] = 245;
	  r[113] = 240; g[113] = 242; b[113] = 245;
	  r[114] = 241; g[114] = 243; b[114] = 245;
	  r[115] = 241; g[115] = 244; b[115] = 246;
	  r[116] = 242; g[116] = 244; b[116] = 246;
	  r[117] = 243; g[117] = 244; b[117] = 246;
	  r[118] = 243; g[118] = 245; b[118] = 246;
	  r[119] = 244; g[119] = 245; b[119] = 246;
	  r[120] = 244; g[120] = 246; b[120] = 246;
	  r[121] = 245; g[121] = 246; b[121] = 247;
	  r[122] = 245; g[122] = 246; b[122] = 247;
	  r[123] = 245; g[123] = 247; b[123] = 247;
	  r[124] = 246; g[124] = 247; b[124] = 247;
	  r[125] = 246; g[125] = 247; b[125] = 247;
	  r[126] = 247; g[126] = 247; b[126] = 247;
	  r[127] = 247; g[127] = 247; b[127] = 247;
	  r[128] = 247; g[128] = 247; b[128] = 247;
	  r[129] = 247; g[129] = 247; b[129] = 247;
	  r[130] = 248; g[130] = 247; b[130] = 247;
	  r[131] = 248; g[131] = 247; b[131] = 246;
	  r[132] = 248; g[132] = 247; b[132] = 246;
	  r[133] = 248; g[133] = 246; b[133] = 245;
	  r[134] = 249; g[134] = 246; b[134] = 245;
	  r[135] = 249; g[135] = 246; b[135] = 244;
	  r[136] = 249; g[136] = 246; b[136] = 243;
	  r[137] = 249; g[137] = 245; b[137] = 242;
	  r[138] = 250; g[138] = 245; b[138] = 241;
	  r[139] = 250; g[139] = 245; b[139] = 240;
	  r[140] = 250; g[140] = 244; b[140] = 239;
	  r[141] = 250; g[141] = 244; b[141] = 237;
	  r[142] = 251; g[142] = 243; b[142] = 236;
	  r[143] = 251; g[143] = 243; b[143] = 234;
	  r[144] = 251; g[144] = 242; b[144] = 233;
	  r[145] = 251; g[145] = 242; b[145] = 231;
	  r[146] = 251; g[146] = 241; b[146] = 230;
	  r[147] = 252; g[147] = 241; b[147] = 228;
	  r[148] = 252; g[148] = 240; b[148] = 226;
	  r[149] = 252; g[149] = 240; b[149] = 225;
	  r[150] = 252; g[150] = 239; b[150] = 223;
	  r[151] = 252; g[151] = 238; b[151] = 221;
	  r[152] = 252; g[152] = 238; b[152] = 219;
	  r[153] = 253; g[153] = 237; b[153] = 217;
	  r[154] = 253; g[154] = 236; b[154] = 215;
	  r[155] = 253; g[155] = 236; b[155] = 213;
	  r[156] = 253; g[156] = 235; b[156] = 211;
	  r[157] = 253; g[157] = 234; b[157] = 209;
	  r[158] = 253; g[158] = 233; b[158] = 207;
	  r[159] = 253; g[159] = 233; b[159] = 205;
	  r[160] = 254; g[160] = 232; b[160] = 203;
	  r[161] = 254; g[161] = 231; b[161] = 201;
	  r[162] = 254; g[162] = 230; b[162] = 198;
	  r[163] = 254; g[163] = 230; b[163] = 196;
	  r[164] = 254; g[164] = 229; b[164] = 194;
	  r[165] = 254; g[165] = 228; b[165] = 192;
	  r[166] = 254; g[166] = 227; b[166] = 190;
	  r[167] = 254; g[167] = 226; b[167] = 188;
	  r[168] = 254; g[168] = 226; b[168] = 186;
	  r[169] = 254; g[169] = 225; b[169] = 184;
	  r[170] = 254; g[170] = 224; b[170] = 182;
	  r[171] = 254; g[171] = 223; b[171] = 180;
	  r[172] = 254; g[172] = 222; b[172] = 178;
	  r[173] = 254; g[173] = 221; b[173] = 176;
	  r[174] = 254; g[174] = 220; b[174] = 173;
	  r[175] = 254; g[175] = 219; b[175] = 171;
	  r[176] = 254; g[176] = 218; b[176] = 168;
	  r[177] = 254; g[177] = 217; b[177] = 166;
	  r[178] = 253; g[178] = 216; b[178] = 163;
	  r[179] = 253; g[179] = 215; b[179] = 160;
	  r[180] = 253; g[180] = 214; b[180] = 157;
	  r[181] = 253; g[181] = 212; b[181] = 154;
	  r[182] = 253; g[182] = 211; b[182] = 151;
	  r[183] = 252; g[183] = 210; b[183] = 148;
	  r[184] = 252; g[184] = 208; b[184] = 145;
	  r[185] = 252; g[185] = 207; b[185] = 142;
	  r[186] = 252; g[186] = 206; b[186] = 139;
	  r[187] = 251; g[187] = 204; b[187] = 136;
	  r[188] = 251; g[188] = 203; b[188] = 133;
	  r[189] = 251; g[189] = 201; b[189] = 129;
	  r[190] = 251; g[190] = 200; b[190] = 126;
	  r[191] = 250; g[191] = 198; b[191] = 123;
	  r[192] = 250; g[192] = 197; b[192] = 120;
	  r[193] = 250; g[193] = 195; b[193] = 117;
	  r[194] = 249; g[194] = 193; b[194] = 113;
	  r[195] = 249; g[195] = 192; b[195] = 110;
	  r[196] = 248; g[196] = 190; b[196] = 107;
	  r[197] = 248; g[197] = 189; b[197] = 104;
	  r[198] = 248; g[198] = 187; b[198] = 101;
	  r[199] = 247; g[199] = 185; b[199] =  98;
	  r[200] = 247; g[200] = 184; b[200] =  95;
	  r[201] = 246; g[201] = 182; b[201] =  92;
	  r[202] = 246; g[202] = 180; b[202] =  89;
	  r[203] = 246; g[203] = 179; b[203] =  86;
	  r[204] = 245; g[204] = 177; b[204] =  84;
	  r[205] = 245; g[205] = 175; b[205] =  81;
	  r[206] = 244; g[206] = 174; b[206] =  78;
	  r[207] = 244; g[207] = 172; b[207] =  76;
	  r[208] = 243; g[208] = 170; b[208] =  73;
	  r[209] = 243; g[209] = 169; b[209] =  71;
	  r[210] = 242; g[210] = 167; b[210] =  69;
	  r[211] = 242; g[211] = 165; b[211] =  67;
	  r[212] = 241; g[212] = 164; b[212] =  65;
	  r[213] = 241; g[213] = 162; b[213] =  63;
	  r[214] = 240; g[214] = 161; b[214] =  61;
	  r[215] = 240; g[215] = 159; b[215] =  59;
	  r[216] = 239; g[216] = 157; b[216] =  58;
	  r[217] = 238; g[217] = 156; b[217] =  56;
	  r[218] = 237; g[218] = 154; b[218] =  54;
	  r[219] = 236; g[219] = 153; b[219] =  52;
	  r[220] = 236; g[220] = 151; b[220] =  51;
	  r[221] = 235; g[221] = 149; b[221] =  49;
	  r[222] = 234; g[222] = 148; b[222] =  47;
	  r[223] = 232; g[223] = 146; b[223] =  46;
	  r[224] = 231; g[224] = 144; b[224] =  44;
	  r[225] = 230; g[225] = 143; b[225] =  42;
	  r[226] = 229; g[226] = 141; b[226] =  41;
	  r[227] = 228; g[227] = 139; b[227] =  39;
	  r[228] = 226; g[228] = 137; b[228] =  37;
	  r[229] = 225; g[229] = 136; b[229] =  36;
	  r[230] = 224; g[230] = 134; b[230] =  34;
	  r[231] = 222; g[231] = 132; b[231] =  33;
	  r[232] = 221; g[232] = 130; b[232] =  31;
	  r[233] = 219; g[233] = 129; b[233] =  30;
	  r[234] = 218; g[234] = 127; b[234] =  28;
	  r[235] = 216; g[235] = 125; b[235] =  27;
	  r[236] = 215; g[236] = 123; b[236] =  26;
	  r[237] = 213; g[237] = 122; b[237] =  24;
	  r[238] = 211; g[238] = 120; b[238] =  23;
	  r[239] = 210; g[239] = 118; b[239] =  22;
	  r[240] = 208; g[240] = 116; b[240] =  20;
	  r[241] = 206; g[241] = 114; b[241] =  19;
	  r[242] = 204; g[242] = 112; b[242] =  18;
	  r[243] = 202; g[243] = 111; b[243] =  17;
	  r[244] = 201; g[244] = 109; b[244] =  16;
	  r[245] = 199; g[245] = 107; b[245] =  15;
	  r[246] = 197; g[246] = 105; b[246] =  14;
	  r[247] = 195; g[247] = 103; b[247] =  13;
	  r[248] = 193; g[248] = 101; b[248] =  12;
	  r[249] = 191; g[249] =  99; b[249] =  11;
	  r[250] = 189; g[250] =  98; b[250] =  10;
	  r[251] = 187; g[251] =  96; b[251] =   9;
	  r[252] = 185; g[252] =  94; b[252] =   8;
	  r[253] = 183; g[253] =  92; b[253] =   7;
	  r[254] = 181; g[254] =  90; b[254] =   7;
	  r[255] = 179; g[255] =  88; b[255] =   6;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_BLUE_RED)
    {
      /***********************************************************************/

      /***** Blue-red palette ************************************************/

      if (colors == 256)
	{
	  r[  0] =   5; g[  0] =  48; b[  0] =  97;
	  r[  1] =   6; g[  1] =  50; b[  1] = 101;
	  r[  2] =   7; g[  2] =  53; b[  2] = 105;
	  r[  3] =   8; g[  3] =  55; b[  3] = 109;
	  r[  4] =   9; g[  4] =  57; b[  4] = 112;
	  r[  5] =  10; g[  5] =  59; b[  5] = 116;
	  r[  6] =  11; g[  6] =  62; b[  6] = 120;
	  r[  7] =  12; g[  7] =  64; b[  7] = 124;
	  r[  8] =  13; g[  8] =  66; b[  8] = 127;
	  r[  9] =  14; g[  9] =  68; b[  9] = 131;
	  r[ 10] =  15; g[ 10] =  70; b[ 10] = 134;
	  r[ 11] =  16; g[ 11] =  72; b[ 11] = 137;
	  r[ 12] =  17; g[ 12] =  75; b[ 12] = 140;
	  r[ 13] =  19; g[ 13] =  77; b[ 13] = 143;
	  r[ 14] =  20; g[ 14] =  79; b[ 14] = 146;
	  r[ 15] =  21; g[ 15] =  81; b[ 15] = 149;
	  r[ 16] =  22; g[ 16] =  83; b[ 16] = 152;
	  r[ 17] =  23; g[ 17] =  85; b[ 17] = 155;
	  r[ 18] =  24; g[ 18] =  87; b[ 18] = 157;
	  r[ 19] =  25; g[ 19] =  89; b[ 19] = 160;
	  r[ 20] =  26; g[ 20] =  91; b[ 20] = 162;
	  r[ 21] =  28; g[ 21] =  93; b[ 21] = 164;
	  r[ 22] =  29; g[ 22] =  95; b[ 22] = 166;
	  r[ 23] =  30; g[ 23] =  97; b[ 23] = 168;
	  r[ 24] =  31; g[ 24] =  99; b[ 24] = 170;
	  r[ 25] =  32; g[ 25] = 101; b[ 25] = 171;
	  r[ 26] =  34; g[ 26] = 103; b[ 26] = 173;
	  r[ 27] =  35; g[ 27] = 105; b[ 27] = 174;
	  r[ 28] =  36; g[ 28] = 107; b[ 28] = 175;
	  r[ 29] =  37; g[ 29] = 109; b[ 29] = 176;
	  r[ 30] =  38; g[ 30] = 110; b[ 30] = 177;
	  r[ 31] =  39; g[ 31] = 112; b[ 31] = 179;
	  r[ 32] =  41; g[ 32] = 114; b[ 32] = 180;
	  r[ 33] =  42; g[ 33] = 116; b[ 33] = 180;
	  r[ 34] =  43; g[ 34] = 117; b[ 34] = 181;
	  r[ 35] =  44; g[ 35] = 119; b[ 35] = 182;
	  r[ 36] =  45; g[ 36] = 121; b[ 36] = 183;
	  r[ 37] =  46; g[ 37] = 123; b[ 37] = 184;
	  r[ 38] =  48; g[ 38] = 124; b[ 38] = 185;
	  r[ 39] =  49; g[ 39] = 126; b[ 39] = 185;
	  r[ 40] =  50; g[ 40] = 128; b[ 40] = 186;
	  r[ 41] =  51; g[ 41] = 129; b[ 41] = 187;
	  r[ 42] =  53; g[ 42] = 131; b[ 42] = 188;
	  r[ 43] =  54; g[ 43] = 133; b[ 43] = 188;
	  r[ 44] =  56; g[ 44] = 135; b[ 44] = 189;
	  r[ 45] =  57; g[ 45] = 136; b[ 45] = 190;
	  r[ 46] =  59; g[ 46] = 138; b[ 46] = 191;
	  r[ 47] =  60; g[ 47] = 140; b[ 47] = 191;
	  r[ 48] =  62; g[ 48] = 142; b[ 48] = 192;
	  r[ 49] =  63; g[ 49] = 143; b[ 49] = 193;
	  r[ 50] =  65; g[ 50] = 145; b[ 50] = 194;
	  r[ 51] =  67; g[ 51] = 147; b[ 51] = 195;
	  r[ 52] =  69; g[ 52] = 149; b[ 52] = 196;
	  r[ 53] =  71; g[ 53] = 151; b[ 53] = 197;
	  r[ 54] =  74; g[ 54] = 153; b[ 54] = 198;
	  r[ 55] =  76; g[ 55] = 155; b[ 55] = 199;
	  r[ 56] =  79; g[ 56] = 157; b[ 56] = 200;
	  r[ 57] =  82; g[ 57] = 159; b[ 57] = 201;
	  r[ 58] =  85; g[ 58] = 161; b[ 58] = 202;
	  r[ 59] =  88; g[ 59] = 163; b[ 59] = 204;
	  r[ 60] =  91; g[ 60] = 165; b[ 60] = 205;
	  r[ 61] =  94; g[ 61] = 167; b[ 61] = 206;
	  r[ 62] =  98; g[ 62] = 169; b[ 62] = 207;
	  r[ 63] = 101; g[ 63] = 171; b[ 63] = 208;
	  r[ 64] = 105; g[ 64] = 174; b[ 64] = 209;
	  r[ 65] = 108; g[ 65] = 176; b[ 65] = 210;
	  r[ 66] = 112; g[ 66] = 178; b[ 66] = 211;
	  r[ 67] = 115; g[ 67] = 180; b[ 67] = 213;
	  r[ 68] = 119; g[ 68] = 182; b[ 68] = 214;
	  r[ 69] = 122; g[ 69] = 184; b[ 69] = 215;
	  r[ 70] = 126; g[ 70] = 186; b[ 70] = 216;
	  r[ 71] = 129; g[ 71] = 188; b[ 71] = 217;
	  r[ 72] = 132; g[ 72] = 189; b[ 72] = 218;
	  r[ 73] = 136; g[ 73] = 191; b[ 73] = 219;
	  r[ 74] = 139; g[ 74] = 193; b[ 74] = 220;
	  r[ 75] = 142; g[ 75] = 195; b[ 75] = 221;
	  r[ 76] = 145; g[ 76] = 196; b[ 76] = 222;
	  r[ 77] = 147; g[ 77] = 198; b[ 77] = 222;
	  r[ 78] = 150; g[ 78] = 199; b[ 78] = 223;
	  r[ 79] = 153; g[ 79] = 201; b[ 79] = 224;
	  r[ 80] = 156; g[ 80] = 202; b[ 80] = 225;
	  r[ 81] = 158; g[ 81] = 204; b[ 81] = 226;
	  r[ 82] = 161; g[ 82] = 205; b[ 82] = 227;
	  r[ 83] = 164; g[ 83] = 207; b[ 83] = 227;
	  r[ 84] = 167; g[ 84] = 208; b[ 84] = 228;
	  r[ 85] = 169; g[ 85] = 209; b[ 85] = 229;
	  r[ 86] = 172; g[ 86] = 211; b[ 86] = 230;
	  r[ 87] = 175; g[ 87] = 212; b[ 87] = 231;
	  r[ 88] = 177; g[ 88] = 213; b[ 88] = 231;
	  r[ 89] = 180; g[ 89] = 215; b[ 89] = 232;
	  r[ 90] = 182; g[ 90] = 216; b[ 90] = 233;
	  r[ 91] = 185; g[ 91] = 217; b[ 91] = 234;
	  r[ 92] = 187; g[ 92] = 218; b[ 92] = 234;
	  r[ 93] = 190; g[ 93] = 220; b[ 93] = 235;
	  r[ 94] = 192; g[ 94] = 221; b[ 94] = 236;
	  r[ 95] = 194; g[ 95] = 222; b[ 95] = 236;
	  r[ 96] = 197; g[ 96] = 223; b[ 96] = 237;
	  r[ 97] = 199; g[ 97] = 224; b[ 97] = 238;
	  r[ 98] = 201; g[ 98] = 225; b[ 98] = 238;
	  r[ 99] = 203; g[ 99] = 226; b[ 99] = 239;
	  r[100] = 205; g[100] = 227; b[100] = 239;
	  r[101] = 207; g[101] = 228; b[101] = 240;
	  r[102] = 209; g[102] = 229; b[102] = 240;
	  r[103] = 211; g[103] = 230; b[103] = 240;
	  r[104] = 213; g[104] = 231; b[104] = 241;
	  r[105] = 215; g[105] = 232; b[105] = 241;
	  r[106] = 217; g[106] = 233; b[106] = 242;
	  r[107] = 218; g[107] = 234; b[107] = 242;
	  r[108] = 220; g[108] = 235; b[108] = 242;
	  r[109] = 222; g[109] = 236; b[109] = 243;
	  r[110] = 224; g[110] = 237; b[110] = 243;
	  r[111] = 226; g[111] = 238; b[111] = 243;
	  r[112] = 228; g[112] = 238; b[112] = 244;
	  r[113] = 230; g[113] = 239; b[113] = 244;
	  r[114] = 231; g[114] = 240; b[114] = 245;
	  r[115] = 233; g[115] = 241; b[115] = 245;
	  r[116] = 235; g[116] = 242; b[116] = 245;
	  r[117] = 236; g[117] = 243; b[117] = 245;
	  r[118] = 238; g[118] = 243; b[118] = 246;
	  r[119] = 239; g[119] = 244; b[119] = 246;
	  r[120] = 240; g[120] = 245; b[120] = 246;
	  r[121] = 242; g[121] = 245; b[121] = 246;
	  r[122] = 243; g[122] = 246; b[122] = 247;
	  r[123] = 244; g[123] = 246; b[123] = 247;
	  r[124] = 245; g[124] = 246; b[124] = 247;
	  r[125] = 246; g[125] = 247; b[125] = 247;
	  r[126] = 246; g[126] = 247; b[126] = 247;
	  r[127] = 247; g[127] = 247; b[127] = 247;
	  r[128] = 247; g[128] = 247; b[128] = 247;
	  r[129] = 248; g[129] = 247; b[129] = 247;
	  r[130] = 248; g[130] = 247; b[130] = 246;
	  r[131] = 248; g[131] = 246; b[131] = 245;
	  r[132] = 249; g[132] = 246; b[132] = 244;
	  r[133] = 249; g[133] = 245; b[133] = 243;
	  r[134] = 249; g[134] = 244; b[134] = 242;
	  r[135] = 250; g[135] = 243; b[135] = 240;
	  r[136] = 250; g[136] = 242; b[136] = 239;
	  r[137] = 250; g[137] = 241; b[137] = 237;
	  r[138] = 251; g[138] = 240; b[138] = 235;
	  r[139] = 251; g[139] = 239; b[139] = 233;
	  r[140] = 251; g[140] = 238; b[140] = 231;
	  r[141] = 251; g[141] = 237; b[141] = 228;
	  r[142] = 252; g[142] = 235; b[142] = 226;
	  r[143] = 252; g[143] = 234; b[143] = 224;
	  r[144] = 252; g[144] = 232; b[144] = 221;
	  r[145] = 252; g[145] = 231; b[145] = 219;
	  r[146] = 252; g[146] = 229; b[146] = 216;
	  r[147] = 253; g[147] = 228; b[147] = 214;
	  r[148] = 253; g[148] = 226; b[148] = 211;
	  r[149] = 253; g[149] = 225; b[149] = 208;
	  r[150] = 253; g[150] = 223; b[150] = 206;
	  r[151] = 253; g[151] = 222; b[151] = 204;
	  r[152] = 253; g[152] = 220; b[152] = 201;
	  r[153] = 253; g[153] = 219; b[153] = 199;
	  r[154] = 253; g[154] = 218; b[154] = 197;
	  r[155] = 253; g[155] = 216; b[155] = 194;
	  r[156] = 253; g[156] = 214; b[156] = 192;
	  r[157] = 253; g[157] = 213; b[157] = 189;
	  r[158] = 253; g[158] = 211; b[158] = 187;
	  r[159] = 252; g[159] = 209; b[159] = 184;
	  r[160] = 252; g[160] = 207; b[160] = 181;
	  r[161] = 252; g[161] = 205; b[161] = 179;
	  r[162] = 252; g[162] = 203; b[162] = 176;
	  r[163] = 251; g[163] = 201; b[163] = 173;
	  r[164] = 251; g[164] = 199; b[164] = 170;
	  r[165] = 251; g[165] = 197; b[165] = 167;
	  r[166] = 250; g[166] = 194; b[166] = 164;
	  r[167] = 250; g[167] = 192; b[167] = 161;
	  r[168] = 249; g[168] = 190; b[168] = 158;
	  r[169] = 249; g[169] = 188; b[169] = 155;
	  r[170] = 248; g[170] = 185; b[170] = 153;
	  r[171] = 248; g[171] = 183; b[171] = 150;
	  r[172] = 247; g[172] = 181; b[172] = 147;
	  r[173] = 247; g[173] = 178; b[173] = 144;
	  r[174] = 246; g[174] = 176; b[174] = 141;
	  r[175] = 246; g[175] = 173; b[175] = 139;
	  r[176] = 245; g[176] = 171; b[176] = 136;
	  r[177] = 245; g[177] = 169; b[177] = 134;
	  r[178] = 244; g[178] = 166; b[178] = 131;
	  r[179] = 244; g[179] = 164; b[179] = 129;
	  r[180] = 243; g[180] = 161; b[180] = 126;
	  r[181] = 242; g[181] = 159; b[181] = 124;
	  r[182] = 242; g[182] = 156; b[182] = 122;
	  r[183] = 241; g[183] = 154; b[183] = 120;
	  r[184] = 240; g[184] = 151; b[184] = 117;
	  r[185] = 239; g[185] = 149; b[185] = 115;
	  r[186] = 238; g[186] = 146; b[186] = 113;
	  r[187] = 237; g[187] = 143; b[187] = 110;
	  r[188] = 235; g[188] = 141; b[188] = 108;
	  r[189] = 234; g[189] = 138; b[189] = 106;
	  r[190] = 233; g[190] = 135; b[190] = 104;
	  r[191] = 232; g[191] = 132; b[191] = 102;
	  r[192] = 230; g[192] = 130; b[192] = 100;
	  r[193] = 229; g[193] = 127; b[193] =  98;
	  r[194] = 228; g[194] = 124; b[194] =  95;
	  r[195] = 226; g[195] = 121; b[195] =  93;
	  r[196] = 225; g[196] = 118; b[196] =  91;
	  r[197] = 224; g[197] = 116; b[197] =  89;
	  r[198] = 222; g[198] = 113; b[198] =  88;
	  r[199] = 221; g[199] = 110; b[199] =  86;
	  r[200] = 219; g[200] = 107; b[200] =  84;
	  r[201] = 218; g[201] = 104; b[201] =  82;
	  r[202] = 217; g[202] = 102; b[202] =  80;
	  r[203] = 215; g[203] =  99; b[203] =  79;
	  r[204] = 214; g[204] =  96; b[204] =  77;
	  r[205] = 213; g[205] =  93; b[205] =  75;
	  r[206] = 211; g[206] =  90; b[206] =  74;
	  r[207] = 210; g[207] =  87; b[207] =  72;
	  r[208] = 209; g[208] =  84; b[208] =  71;
	  r[209] = 208; g[209] =  81; b[209] =  69;
	  r[210] = 207; g[210] =  78; b[210] =  67;
	  r[211] = 205; g[211] =  74; b[211] =  66;
	  r[212] = 204; g[212] =  71; b[212] =  64;
	  r[213] = 203; g[213] =  68; b[213] =  63;
	  r[214] = 202; g[214] =  65; b[214] =  61;
	  r[215] = 200; g[215] =  61; b[215] =  60;
	  r[216] = 199; g[216] =  58; b[216] =  58;
	  r[217] = 198; g[217] =  55; b[217] =  57;
	  r[218] = 196; g[218] =  52; b[218] =  55;
	  r[219] = 195; g[219] =  49; b[219] =  54;
	  r[220] = 194; g[220] =  46; b[220] =  53;
	  r[221] = 192; g[221] =  43; b[221] =  51;
	  r[222] = 191; g[222] =  40; b[222] =  50;
	  r[223] = 189; g[223] =  37; b[223] =  49;
	  r[224] = 188; g[224] =  35; b[224] =  48;
	  r[225] = 186; g[225] =  32; b[225] =  47;
	  r[226] = 184; g[226] =  30; b[226] =  46;
	  r[227] = 183; g[227] =  28; b[227] =  45;
	  r[228] = 181; g[228] =  26; b[228] =  44;
	  r[229] = 179; g[229] =  25; b[229] =  43;
	  r[230] = 177; g[230] =  23; b[230] =  43;
	  r[231] = 175; g[231] =  22; b[231] =  42;
	  r[232] = 173; g[232] =  20; b[232] =  41;
	  r[233] = 171; g[233] =  19; b[233] =  41;
	  r[234] = 168; g[234] =  18; b[234] =  40;
	  r[235] = 166; g[235] =  16; b[235] =  39;
	  r[236] = 164; g[236] =  15; b[236] =  39;
	  r[237] = 161; g[237] =  14; b[237] =  38;
	  r[238] = 158; g[238] =  12; b[238] =  37;
	  r[239] = 156; g[239] =  11; b[239] =  37;
	  r[240] = 153; g[240] =  10; b[240] =  36;
	  r[241] = 150; g[241] =   9; b[241] =  36;
	  r[242] = 147; g[242] =   8; b[242] =  35;
	  r[243] = 144; g[243] =   7; b[243] =  35;
	  r[244] = 141; g[244] =   6; b[244] =  34;
	  r[245] = 138; g[245] =   5; b[245] =  34;
	  r[246] = 134; g[246] =   4; b[246] =  33;
	  r[247] = 131; g[247] =   3; b[247] =  33;
	  r[248] = 128; g[248] =   2; b[248] =  32;
	  r[249] = 124; g[249] =   2; b[249] =  32;
	  r[250] = 121; g[250] =   1; b[250] =  32;
	  r[251] = 117; g[251] =   1; b[251] =  32;
	  r[252] = 114; g[252] =   0; b[252] =  31;
	  r[253] = 110; g[253] =   0; b[253] =  31;
	  r[254] = 107; g[254] =   0; b[254] =  31;
	  r[255] = 103; g[255] =   0; b[255] =  31;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_HSV)
    {
      /***********************************************************************/

      /***** HSV palette *****************************************************/

      if (colors == 256)
	{
	  /* Colormap from matlab */

	  r[  0] = 255; g[  0] =   0; b[  0] =   0;
	  r[  1] = 255; g[  1] =   6; b[  1] =   0;
	  r[  2] = 255; g[  2] =  12; b[  2] =   0;
	  r[  3] = 255; g[  3] =  18; b[  3] =   0;
	  r[  4] = 255; g[  4] =  24; b[  4] =   0;
	  r[  5] = 255; g[  5] =  30; b[  5] =   0;
	  r[  6] = 255; g[  6] =  36; b[  6] =   0;
	  r[  7] = 255; g[  7] =  42; b[  7] =   0;
	  r[  8] = 255; g[  8] =  48; b[  8] =   0;
	  r[  9] = 255; g[  9] =  54; b[  9] =   0;
	  r[ 10] = 255; g[ 10] =  60; b[ 10] =   0;
	  r[ 11] = 255; g[ 11] =  66; b[ 11] =   0;
	  r[ 12] = 255; g[ 12] =  72; b[ 12] =   0;
	  r[ 13] = 255; g[ 13] =  78; b[ 13] =   0;
	  r[ 14] = 255; g[ 14] =  84; b[ 14] =   0;
	  r[ 15] = 255; g[ 15] =  90; b[ 15] =   0;
	  r[ 16] = 255; g[ 16] =  96; b[ 16] =   0;
	  r[ 17] = 255; g[ 17] = 102; b[ 17] =   0;
	  r[ 18] = 255; g[ 18] = 108; b[ 18] =   0;
	  r[ 19] = 255; g[ 19] = 114; b[ 19] =   0;
	  r[ 20] = 255; g[ 20] = 120; b[ 20] =   0;
	  r[ 21] = 255; g[ 21] = 126; b[ 21] =   0;
	  r[ 22] = 255; g[ 22] = 131; b[ 22] =   0;
	  r[ 23] = 255; g[ 23] = 137; b[ 23] =   0;
	  r[ 24] = 255; g[ 24] = 143; b[ 24] =   0;
	  r[ 25] = 255; g[ 25] = 149; b[ 25] =   0;
	  r[ 26] = 255; g[ 26] = 155; b[ 26] =   0;
	  r[ 27] = 255; g[ 27] = 161; b[ 27] =   0;
	  r[ 28] = 255; g[ 28] = 167; b[ 28] =   0;
	  r[ 29] = 255; g[ 29] = 173; b[ 29] =   0;
	  r[ 30] = 255; g[ 30] = 179; b[ 30] =   0;
	  r[ 31] = 255; g[ 31] = 185; b[ 31] =   0;
	  r[ 32] = 255; g[ 32] = 191; b[ 32] =   0;
	  r[ 33] = 255; g[ 33] = 197; b[ 33] =   0;
	  r[ 34] = 255; g[ 34] = 203; b[ 34] =   0;
	  r[ 35] = 255; g[ 35] = 209; b[ 35] =   0;
	  r[ 36] = 255; g[ 36] = 215; b[ 36] =   0;
	  r[ 37] = 255; g[ 37] = 221; b[ 37] =   0;
	  r[ 38] = 255; g[ 38] = 227; b[ 38] =   0;
	  r[ 39] = 255; g[ 39] = 233; b[ 39] =   0;
	  r[ 40] = 255; g[ 40] = 239; b[ 40] =   0;
	  r[ 41] = 255; g[ 41] = 245; b[ 41] =   0;
	  r[ 42] = 255; g[ 42] = 251; b[ 42] =   0;
	  r[ 43] = 253; g[ 43] = 255; b[ 43] =   0;
	  r[ 44] = 247; g[ 44] = 255; b[ 44] =   0;
	  r[ 45] = 241; g[ 45] = 255; b[ 45] =   0;
	  r[ 46] = 235; g[ 46] = 255; b[ 46] =   0;
	  r[ 47] = 229; g[ 47] = 255; b[ 47] =   0;
	  r[ 48] = 223; g[ 48] = 255; b[ 48] =   0;
	  r[ 49] = 217; g[ 49] = 255; b[ 49] =   0;
	  r[ 50] = 211; g[ 50] = 255; b[ 50] =   0;
	  r[ 51] = 205; g[ 51] = 255; b[ 51] =   0;
	  r[ 52] = 199; g[ 52] = 255; b[ 52] =   0;
	  r[ 53] = 193; g[ 53] = 255; b[ 53] =   0;
	  r[ 54] = 187; g[ 54] = 255; b[ 54] =   0;
	  r[ 55] = 181; g[ 55] = 255; b[ 55] =   0;
	  r[ 56] = 175; g[ 56] = 255; b[ 56] =   0;
	  r[ 57] = 169; g[ 57] = 255; b[ 57] =   0;
	  r[ 58] = 163; g[ 58] = 255; b[ 58] =   0;
	  r[ 59] = 157; g[ 59] = 255; b[ 59] =   0;
	  r[ 60] = 151; g[ 60] = 255; b[ 60] =   0;
	  r[ 61] = 145; g[ 61] = 255; b[ 61] =   0;
	  r[ 62] = 139; g[ 62] = 255; b[ 62] =   0;
	  r[ 63] = 133; g[ 63] = 255; b[ 63] =   0;
	  r[ 64] = 128; g[ 64] = 255; b[ 64] =   0;
	  r[ 65] = 122; g[ 65] = 255; b[ 65] =   0;
	  r[ 66] = 116; g[ 66] = 255; b[ 66] =   0;
	  r[ 67] = 110; g[ 67] = 255; b[ 67] =   0;
	  r[ 68] = 104; g[ 68] = 255; b[ 68] =   0;
	  r[ 69] =  98; g[ 69] = 255; b[ 69] =   0;
	  r[ 70] =  92; g[ 70] = 255; b[ 70] =   0;
	  r[ 71] =  86; g[ 71] = 255; b[ 71] =   0;
	  r[ 72] =  80; g[ 72] = 255; b[ 72] =   0;
	  r[ 73] =  74; g[ 73] = 255; b[ 73] =   0;
	  r[ 74] =  68; g[ 74] = 255; b[ 74] =   0;
	  r[ 75] =  62; g[ 75] = 255; b[ 75] =   0;
	  r[ 76] =  56; g[ 76] = 255; b[ 76] =   0;
	  r[ 77] =  50; g[ 77] = 255; b[ 77] =   0;
	  r[ 78] =  44; g[ 78] = 255; b[ 78] =   0;
	  r[ 79] =  38; g[ 79] = 255; b[ 79] =   0;
	  r[ 80] =  32; g[ 80] = 255; b[ 80] =   0;
	  r[ 81] =  26; g[ 81] = 255; b[ 81] =   0;
	  r[ 82] =  20; g[ 82] = 255; b[ 82] =   0;
	  r[ 83] =  14; g[ 83] = 255; b[ 83] =   0;
	  r[ 84] =   8; g[ 84] = 255; b[ 84] =   0;
	  r[ 85] =   2; g[ 85] = 255; b[ 85] =   0;
	  r[ 86] =   0; g[ 86] = 255; b[ 86] =   4;
	  r[ 87] =   0; g[ 87] = 255; b[ 87] =  10;
	  r[ 88] =   0; g[ 88] = 255; b[ 88] =  16;
	  r[ 89] =   0; g[ 89] = 255; b[ 89] =  22;
	  r[ 90] =   0; g[ 90] = 255; b[ 90] =  28;
	  r[ 91] =   0; g[ 91] = 255; b[ 91] =  34;
	  r[ 92] =   0; g[ 92] = 255; b[ 92] =  40;
	  r[ 93] =   0; g[ 93] = 255; b[ 93] =  46;
	  r[ 94] =   0; g[ 94] = 255; b[ 94] =  52;
	  r[ 95] =   0; g[ 95] = 255; b[ 95] =  58;
	  r[ 96] =   0; g[ 96] = 255; b[ 96] =  64;
	  r[ 97] =   0; g[ 97] = 255; b[ 97] =  70;
	  r[ 98] =   0; g[ 98] = 255; b[ 98] =  76;
	  r[ 99] =   0; g[ 99] = 255; b[ 99] =  82;
	  r[100] =   0; g[100] = 255; b[100] =  88;
	  r[101] =   0; g[101] = 255; b[101] =  94;
	  r[102] =   0; g[102] = 255; b[102] = 100;
	  r[103] =   0; g[103] = 255; b[103] = 106;
	  r[104] =   0; g[104] = 255; b[104] = 112;
	  r[105] =   0; g[105] = 255; b[105] = 118;
	  r[106] =   0; g[106] = 255; b[106] = 124;
	  r[107] =   0; g[107] = 255; b[107] = 129;
	  r[108] =   0; g[108] = 255; b[108] = 135;
	  r[109] =   0; g[109] = 255; b[109] = 141;
	  r[110] =   0; g[110] = 255; b[110] = 147;
	  r[111] =   0; g[111] = 255; b[111] = 153;
	  r[112] =   0; g[112] = 255; b[112] = 159;
	  r[113] =   0; g[113] = 255; b[113] = 165;
	  r[114] =   0; g[114] = 255; b[114] = 171;
	  r[115] =   0; g[115] = 255; b[115] = 177;
	  r[116] =   0; g[116] = 255; b[116] = 183;
	  r[117] =   0; g[117] = 255; b[117] = 189;
	  r[118] =   0; g[118] = 255; b[118] = 195;
	  r[119] =   0; g[119] = 255; b[119] = 201;
	  r[120] =   0; g[120] = 255; b[120] = 207;
	  r[121] =   0; g[121] = 255; b[121] = 213;
	  r[122] =   0; g[122] = 255; b[122] = 219;
	  r[123] =   0; g[123] = 255; b[123] = 225;
	  r[124] =   0; g[124] = 255; b[124] = 231;
	  r[125] =   0; g[125] = 255; b[125] = 237;
	  r[126] =   0; g[126] = 255; b[126] = 243;
	  r[127] =   0; g[127] = 255; b[127] = 249;
	  r[128] =   0; g[128] = 255; b[128] = 255;
	  r[129] =   0; g[129] = 249; b[129] = 255;
	  r[130] =   0; g[130] = 243; b[130] = 255;
	  r[131] =   0; g[131] = 237; b[131] = 255;
	  r[132] =   0; g[132] = 231; b[132] = 255;
	  r[133] =   0; g[133] = 225; b[133] = 255;
	  r[134] =   0; g[134] = 219; b[134] = 255;
	  r[135] =   0; g[135] = 213; b[135] = 255;
	  r[136] =   0; g[136] = 207; b[136] = 255;
	  r[137] =   0; g[137] = 201; b[137] = 255;
	  r[138] =   0; g[138] = 195; b[138] = 255;
	  r[139] =   0; g[139] = 189; b[139] = 255;
	  r[140] =   0; g[140] = 183; b[140] = 255;
	  r[141] =   0; g[141] = 177; b[141] = 255;
	  r[142] =   0; g[142] = 171; b[142] = 255;
	  r[143] =   0; g[143] = 165; b[143] = 255;
	  r[144] =   0; g[144] = 159; b[144] = 255;
	  r[145] =   0; g[145] = 153; b[145] = 255;
	  r[146] =   0; g[146] = 147; b[146] = 255;
	  r[147] =   0; g[147] = 141; b[147] = 255;
	  r[148] =   0; g[148] = 135; b[148] = 255;
	  r[149] =   0; g[149] = 129; b[149] = 255;
	  r[150] =   0; g[150] = 124; b[150] = 255;
	  r[151] =   0; g[151] = 118; b[151] = 255;
	  r[152] =   0; g[152] = 112; b[152] = 255;
	  r[153] =   0; g[153] = 106; b[153] = 255;
	  r[154] =   0; g[154] = 100; b[154] = 255;
	  r[155] =   0; g[155] =  94; b[155] = 255;
	  r[156] =   0; g[156] =  88; b[156] = 255;
	  r[157] =   0; g[157] =  82; b[157] = 255;
	  r[158] =   0; g[158] =  76; b[158] = 255;
	  r[159] =   0; g[159] =  70; b[159] = 255;
	  r[160] =   0; g[160] =  64; b[160] = 255;
	  r[161] =   0; g[161] =  58; b[161] = 255;
	  r[162] =   0; g[162] =  52; b[162] = 255;
	  r[163] =   0; g[163] =  46; b[163] = 255;
	  r[164] =   0; g[164] =  40; b[164] = 255;
	  r[165] =   0; g[165] =  34; b[165] = 255;
	  r[166] =   0; g[166] =  28; b[166] = 255;
	  r[167] =   0; g[167] =  22; b[167] = 255;
	  r[168] =   0; g[168] =  16; b[168] = 255;
	  r[169] =   0; g[169] =  10; b[169] = 255;
	  r[170] =   0; g[170] =   4; b[170] = 255;
	  r[171] =   2; g[171] =   0; b[171] = 255;
	  r[172] =   8; g[172] =   0; b[172] = 255;
	  r[173] =  14; g[173] =   0; b[173] = 255;
	  r[174] =  20; g[174] =   0; b[174] = 255;
	  r[175] =  26; g[175] =   0; b[175] = 255;
	  r[176] =  32; g[176] =   0; b[176] = 255;
	  r[177] =  38; g[177] =   0; b[177] = 255;
	  r[178] =  44; g[178] =   0; b[178] = 255;
	  r[179] =  50; g[179] =   0; b[179] = 255;
	  r[180] =  56; g[180] =   0; b[180] = 255;
	  r[181] =  62; g[181] =   0; b[181] = 255;
	  r[182] =  68; g[182] =   0; b[182] = 255;
	  r[183] =  74; g[183] =   0; b[183] = 255;
	  r[184] =  80; g[184] =   0; b[184] = 255;
	  r[185] =  86; g[185] =   0; b[185] = 255;
	  r[186] =  92; g[186] =   0; b[186] = 255;
	  r[187] =  98; g[187] =   0; b[187] = 255;
	  r[188] = 104; g[188] =   0; b[188] = 255;
	  r[189] = 110; g[189] =   0; b[189] = 255;
	  r[190] = 116; g[190] =   0; b[190] = 255;
	  r[191] = 122; g[191] =   0; b[191] = 255;
	  r[192] = 128; g[192] =   0; b[192] = 255;
	  r[193] = 133; g[193] =   0; b[193] = 255;
	  r[194] = 139; g[194] =   0; b[194] = 255;
	  r[195] = 145; g[195] =   0; b[195] = 255;
	  r[196] = 151; g[196] =   0; b[196] = 255;
	  r[197] = 157; g[197] =   0; b[197] = 255;
	  r[198] = 163; g[198] =   0; b[198] = 255;
	  r[199] = 169; g[199] =   0; b[199] = 255;
	  r[200] = 175; g[200] =   0; b[200] = 255;
	  r[201] = 181; g[201] =   0; b[201] = 255;
	  r[202] = 187; g[202] =   0; b[202] = 255;
	  r[203] = 193; g[203] =   0; b[203] = 255;
	  r[204] = 199; g[204] =   0; b[204] = 255;
	  r[205] = 205; g[205] =   0; b[205] = 255;
	  r[206] = 211; g[206] =   0; b[206] = 255;
	  r[207] = 217; g[207] =   0; b[207] = 255;
	  r[208] = 223; g[208] =   0; b[208] = 255;
	  r[209] = 229; g[209] =   0; b[209] = 255;
	  r[210] = 235; g[210] =   0; b[210] = 255;
	  r[211] = 241; g[211] =   0; b[211] = 255;
	  r[212] = 247; g[212] =   0; b[212] = 255;
	  r[213] = 253; g[213] =   0; b[213] = 255;
	  r[214] = 255; g[214] =   0; b[214] = 251;
	  r[215] = 255; g[215] =   0; b[215] = 245;
	  r[216] = 255; g[216] =   0; b[216] = 239;
	  r[217] = 255; g[217] =   0; b[217] = 233;
	  r[218] = 255; g[218] =   0; b[218] = 227;
	  r[219] = 255; g[219] =   0; b[219] = 221;
	  r[220] = 255; g[220] =   0; b[220] = 215;
	  r[221] = 255; g[221] =   0; b[221] = 209;
	  r[222] = 255; g[222] =   0; b[222] = 203;
	  r[223] = 255; g[223] =   0; b[223] = 197;
	  r[224] = 255; g[224] =   0; b[224] = 191;
	  r[225] = 255; g[225] =   0; b[225] = 185;
	  r[226] = 255; g[226] =   0; b[226] = 179;
	  r[227] = 255; g[227] =   0; b[227] = 173;
	  r[228] = 255; g[228] =   0; b[228] = 167;
	  r[229] = 255; g[229] =   0; b[229] = 161;
	  r[230] = 255; g[230] =   0; b[230] = 155;
	  r[231] = 255; g[231] =   0; b[231] = 149;
	  r[232] = 255; g[232] =   0; b[232] = 143;
	  r[233] = 255; g[233] =   0; b[233] = 137;
	  r[234] = 255; g[234] =   0; b[234] = 131;
	  r[235] = 255; g[235] =   0; b[235] = 126;
	  r[236] = 255; g[236] =   0; b[236] = 120;
	  r[237] = 255; g[237] =   0; b[237] = 114;
	  r[238] = 255; g[238] =   0; b[238] = 108;
	  r[239] = 255; g[239] =   0; b[239] = 102;
	  r[240] = 255; g[240] =   0; b[240] =  96;
	  r[241] = 255; g[241] =   0; b[241] =  90;
	  r[242] = 255; g[242] =   0; b[242] =  84;
	  r[243] = 255; g[243] =   0; b[243] =  78;
	  r[244] = 255; g[244] =   0; b[244] =  72;
	  r[245] = 255; g[245] =   0; b[245] =  66;
	  r[246] = 255; g[246] =   0; b[246] =  60;
	  r[247] = 255; g[247] =   0; b[247] =  54;
	  r[248] = 255; g[248] =   0; b[248] =  48;
	  r[249] = 255; g[249] =   0; b[249] =  42;
	  r[250] = 255; g[250] =   0; b[250] =  36;
	  r[251] = 255; g[251] =   0; b[251] =  30;
	  r[252] = 255; g[252] =   0; b[252] =  24;
	  r[253] = 255; g[253] =   0; b[253] =  18;
	  r[254] = 255; g[254] =   0; b[254] =  12;
	  r[255] = 255; g[255] =   0; b[255] =   6;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_SPRING)
    {
      /***********************************************************************/

      /***** Spring palette **************************************************/

      if (colors == 256)
	{
	  /* Colormap from matlab */

	  r[  0] = 255; g[  0] =   0; b[  0] = 255;
	  r[  1] = 255; g[  1] =   1; b[  1] = 254;
	  r[  2] = 255; g[  2] =   2; b[  2] = 253;
	  r[  3] = 255; g[  3] =   3; b[  3] = 252;
	  r[  4] = 255; g[  4] =   4; b[  4] = 251;
	  r[  5] = 255; g[  5] =   5; b[  5] = 250;
	  r[  6] = 255; g[  6] =   6; b[  6] = 249;
	  r[  7] = 255; g[  7] =   7; b[  7] = 248;
	  r[  8] = 255; g[  8] =   8; b[  8] = 247;
	  r[  9] = 255; g[  9] =   9; b[  9] = 246;
	  r[ 10] = 255; g[ 10] =  10; b[ 10] = 245;
	  r[ 11] = 255; g[ 11] =  11; b[ 11] = 244;
	  r[ 12] = 255; g[ 12] =  12; b[ 12] = 243;
	  r[ 13] = 255; g[ 13] =  13; b[ 13] = 242;
	  r[ 14] = 255; g[ 14] =  14; b[ 14] = 241;
	  r[ 15] = 255; g[ 15] =  15; b[ 15] = 240;
	  r[ 16] = 255; g[ 16] =  16; b[ 16] = 239;
	  r[ 17] = 255; g[ 17] =  17; b[ 17] = 238;
	  r[ 18] = 255; g[ 18] =  18; b[ 18] = 237;
	  r[ 19] = 255; g[ 19] =  19; b[ 19] = 236;
	  r[ 20] = 255; g[ 20] =  20; b[ 20] = 235;
	  r[ 21] = 255; g[ 21] =  21; b[ 21] = 234;
	  r[ 22] = 255; g[ 22] =  22; b[ 22] = 233;
	  r[ 23] = 255; g[ 23] =  23; b[ 23] = 232;
	  r[ 24] = 255; g[ 24] =  24; b[ 24] = 231;
	  r[ 25] = 255; g[ 25] =  25; b[ 25] = 230;
	  r[ 26] = 255; g[ 26] =  26; b[ 26] = 229;
	  r[ 27] = 255; g[ 27] =  27; b[ 27] = 228;
	  r[ 28] = 255; g[ 28] =  28; b[ 28] = 227;
	  r[ 29] = 255; g[ 29] =  29; b[ 29] = 226;
	  r[ 30] = 255; g[ 30] =  30; b[ 30] = 225;
	  r[ 31] = 255; g[ 31] =  31; b[ 31] = 224;
	  r[ 32] = 255; g[ 32] =  32; b[ 32] = 223;
	  r[ 33] = 255; g[ 33] =  33; b[ 33] = 222;
	  r[ 34] = 255; g[ 34] =  34; b[ 34] = 221;
	  r[ 35] = 255; g[ 35] =  35; b[ 35] = 220;
	  r[ 36] = 255; g[ 36] =  36; b[ 36] = 219;
	  r[ 37] = 255; g[ 37] =  37; b[ 37] = 218;
	  r[ 38] = 255; g[ 38] =  38; b[ 38] = 217;
	  r[ 39] = 255; g[ 39] =  39; b[ 39] = 216;
	  r[ 40] = 255; g[ 40] =  40; b[ 40] = 215;
	  r[ 41] = 255; g[ 41] =  41; b[ 41] = 214;
	  r[ 42] = 255; g[ 42] =  42; b[ 42] = 213;
	  r[ 43] = 255; g[ 43] =  43; b[ 43] = 212;
	  r[ 44] = 255; g[ 44] =  44; b[ 44] = 211;
	  r[ 45] = 255; g[ 45] =  45; b[ 45] = 210;
	  r[ 46] = 255; g[ 46] =  46; b[ 46] = 209;
	  r[ 47] = 255; g[ 47] =  47; b[ 47] = 208;
	  r[ 48] = 255; g[ 48] =  48; b[ 48] = 207;
	  r[ 49] = 255; g[ 49] =  49; b[ 49] = 206;
	  r[ 50] = 255; g[ 50] =  50; b[ 50] = 205;
	  r[ 51] = 255; g[ 51] =  51; b[ 51] = 204;
	  r[ 52] = 255; g[ 52] =  52; b[ 52] = 203;
	  r[ 53] = 255; g[ 53] =  53; b[ 53] = 202;
	  r[ 54] = 255; g[ 54] =  54; b[ 54] = 201;
	  r[ 55] = 255; g[ 55] =  55; b[ 55] = 200;
	  r[ 56] = 255; g[ 56] =  56; b[ 56] = 199;
	  r[ 57] = 255; g[ 57] =  57; b[ 57] = 198;
	  r[ 58] = 255; g[ 58] =  58; b[ 58] = 197;
	  r[ 59] = 255; g[ 59] =  59; b[ 59] = 196;
	  r[ 60] = 255; g[ 60] =  60; b[ 60] = 195;
	  r[ 61] = 255; g[ 61] =  61; b[ 61] = 194;
	  r[ 62] = 255; g[ 62] =  62; b[ 62] = 193;
	  r[ 63] = 255; g[ 63] =  63; b[ 63] = 192;
	  r[ 64] = 255; g[ 64] =  64; b[ 64] = 191;
	  r[ 65] = 255; g[ 65] =  65; b[ 65] = 190;
	  r[ 66] = 255; g[ 66] =  66; b[ 66] = 189;
	  r[ 67] = 255; g[ 67] =  67; b[ 67] = 188;
	  r[ 68] = 255; g[ 68] =  68; b[ 68] = 187;
	  r[ 69] = 255; g[ 69] =  69; b[ 69] = 186;
	  r[ 70] = 255; g[ 70] =  70; b[ 70] = 185;
	  r[ 71] = 255; g[ 71] =  71; b[ 71] = 184;
	  r[ 72] = 255; g[ 72] =  72; b[ 72] = 183;
	  r[ 73] = 255; g[ 73] =  73; b[ 73] = 182;
	  r[ 74] = 255; g[ 74] =  74; b[ 74] = 181;
	  r[ 75] = 255; g[ 75] =  75; b[ 75] = 180;
	  r[ 76] = 255; g[ 76] =  76; b[ 76] = 179;
	  r[ 77] = 255; g[ 77] =  77; b[ 77] = 178;
	  r[ 78] = 255; g[ 78] =  78; b[ 78] = 177;
	  r[ 79] = 255; g[ 79] =  79; b[ 79] = 176;
	  r[ 80] = 255; g[ 80] =  80; b[ 80] = 175;
	  r[ 81] = 255; g[ 81] =  81; b[ 81] = 174;
	  r[ 82] = 255; g[ 82] =  82; b[ 82] = 173;
	  r[ 83] = 255; g[ 83] =  83; b[ 83] = 172;
	  r[ 84] = 255; g[ 84] =  84; b[ 84] = 171;
	  r[ 85] = 255; g[ 85] =  85; b[ 85] = 170;
	  r[ 86] = 255; g[ 86] =  86; b[ 86] = 169;
	  r[ 87] = 255; g[ 87] =  87; b[ 87] = 168;
	  r[ 88] = 255; g[ 88] =  88; b[ 88] = 167;
	  r[ 89] = 255; g[ 89] =  89; b[ 89] = 166;
	  r[ 90] = 255; g[ 90] =  90; b[ 90] = 165;
	  r[ 91] = 255; g[ 91] =  91; b[ 91] = 164;
	  r[ 92] = 255; g[ 92] =  92; b[ 92] = 163;
	  r[ 93] = 255; g[ 93] =  93; b[ 93] = 162;
	  r[ 94] = 255; g[ 94] =  94; b[ 94] = 161;
	  r[ 95] = 255; g[ 95] =  95; b[ 95] = 160;
	  r[ 96] = 255; g[ 96] =  96; b[ 96] = 159;
	  r[ 97] = 255; g[ 97] =  97; b[ 97] = 158;
	  r[ 98] = 255; g[ 98] =  98; b[ 98] = 157;
	  r[ 99] = 255; g[ 99] =  99; b[ 99] = 156;
	  r[100] = 255; g[100] = 100; b[100] = 155;
	  r[101] = 255; g[101] = 101; b[101] = 154;
	  r[102] = 255; g[102] = 102; b[102] = 153;
	  r[103] = 255; g[103] = 103; b[103] = 152;
	  r[104] = 255; g[104] = 104; b[104] = 151;
	  r[105] = 255; g[105] = 105; b[105] = 150;
	  r[106] = 255; g[106] = 106; b[106] = 149;
	  r[107] = 255; g[107] = 107; b[107] = 148;
	  r[108] = 255; g[108] = 108; b[108] = 147;
	  r[109] = 255; g[109] = 109; b[109] = 146;
	  r[110] = 255; g[110] = 110; b[110] = 145;
	  r[111] = 255; g[111] = 111; b[111] = 144;
	  r[112] = 255; g[112] = 112; b[112] = 143;
	  r[113] = 255; g[113] = 113; b[113] = 142;
	  r[114] = 255; g[114] = 114; b[114] = 141;
	  r[115] = 255; g[115] = 115; b[115] = 140;
	  r[116] = 255; g[116] = 116; b[116] = 139;
	  r[117] = 255; g[117] = 117; b[117] = 138;
	  r[118] = 255; g[118] = 118; b[118] = 137;
	  r[119] = 255; g[119] = 119; b[119] = 136;
	  r[120] = 255; g[120] = 120; b[120] = 135;
	  r[121] = 255; g[121] = 121; b[121] = 134;
	  r[122] = 255; g[122] = 122; b[122] = 133;
	  r[123] = 255; g[123] = 123; b[123] = 132;
	  r[124] = 255; g[124] = 124; b[124] = 131;
	  r[125] = 255; g[125] = 125; b[125] = 130;
	  r[126] = 255; g[126] = 126; b[126] = 129;
	  r[127] = 255; g[127] = 127; b[127] = 128;
	  r[128] = 255; g[128] = 128; b[128] = 127;
	  r[129] = 255; g[129] = 129; b[129] = 126;
	  r[130] = 255; g[130] = 130; b[130] = 125;
	  r[131] = 255; g[131] = 131; b[131] = 124;
	  r[132] = 255; g[132] = 132; b[132] = 123;
	  r[133] = 255; g[133] = 133; b[133] = 122;
	  r[134] = 255; g[134] = 134; b[134] = 121;
	  r[135] = 255; g[135] = 135; b[135] = 120;
	  r[136] = 255; g[136] = 136; b[136] = 119;
	  r[137] = 255; g[137] = 137; b[137] = 118;
	  r[138] = 255; g[138] = 138; b[138] = 117;
	  r[139] = 255; g[139] = 139; b[139] = 116;
	  r[140] = 255; g[140] = 140; b[140] = 115;
	  r[141] = 255; g[141] = 141; b[141] = 114;
	  r[142] = 255; g[142] = 142; b[142] = 113;
	  r[143] = 255; g[143] = 143; b[143] = 112;
	  r[144] = 255; g[144] = 144; b[144] = 111;
	  r[145] = 255; g[145] = 145; b[145] = 110;
	  r[146] = 255; g[146] = 146; b[146] = 109;
	  r[147] = 255; g[147] = 147; b[147] = 108;
	  r[148] = 255; g[148] = 148; b[148] = 107;
	  r[149] = 255; g[149] = 149; b[149] = 106;
	  r[150] = 255; g[150] = 150; b[150] = 105;
	  r[151] = 255; g[151] = 151; b[151] = 104;
	  r[152] = 255; g[152] = 152; b[152] = 103;
	  r[153] = 255; g[153] = 153; b[153] = 102;
	  r[154] = 255; g[154] = 154; b[154] = 101;
	  r[155] = 255; g[155] = 155; b[155] = 100;
	  r[156] = 255; g[156] = 156; b[156] =  99;
	  r[157] = 255; g[157] = 157; b[157] =  98;
	  r[158] = 255; g[158] = 158; b[158] =  97;
	  r[159] = 255; g[159] = 159; b[159] =  96;
	  r[160] = 255; g[160] = 160; b[160] =  95;
	  r[161] = 255; g[161] = 161; b[161] =  94;
	  r[162] = 255; g[162] = 162; b[162] =  93;
	  r[163] = 255; g[163] = 163; b[163] =  92;
	  r[164] = 255; g[164] = 164; b[164] =  91;
	  r[165] = 255; g[165] = 165; b[165] =  90;
	  r[166] = 255; g[166] = 166; b[166] =  89;
	  r[167] = 255; g[167] = 167; b[167] =  88;
	  r[168] = 255; g[168] = 168; b[168] =  87;
	  r[169] = 255; g[169] = 169; b[169] =  86;
	  r[170] = 255; g[170] = 170; b[170] =  85;
	  r[171] = 255; g[171] = 171; b[171] =  84;
	  r[172] = 255; g[172] = 172; b[172] =  83;
	  r[173] = 255; g[173] = 173; b[173] =  82;
	  r[174] = 255; g[174] = 174; b[174] =  81;
	  r[175] = 255; g[175] = 175; b[175] =  80;
	  r[176] = 255; g[176] = 176; b[176] =  79;
	  r[177] = 255; g[177] = 177; b[177] =  78;
	  r[178] = 255; g[178] = 178; b[178] =  77;
	  r[179] = 255; g[179] = 179; b[179] =  76;
	  r[180] = 255; g[180] = 180; b[180] =  75;
	  r[181] = 255; g[181] = 181; b[181] =  74;
	  r[182] = 255; g[182] = 182; b[182] =  73;
	  r[183] = 255; g[183] = 183; b[183] =  72;
	  r[184] = 255; g[184] = 184; b[184] =  71;
	  r[185] = 255; g[185] = 185; b[185] =  70;
	  r[186] = 255; g[186] = 186; b[186] =  69;
	  r[187] = 255; g[187] = 187; b[187] =  68;
	  r[188] = 255; g[188] = 188; b[188] =  67;
	  r[189] = 255; g[189] = 189; b[189] =  66;
	  r[190] = 255; g[190] = 190; b[190] =  65;
	  r[191] = 255; g[191] = 191; b[191] =  64;
	  r[192] = 255; g[192] = 192; b[192] =  63;
	  r[193] = 255; g[193] = 193; b[193] =  62;
	  r[194] = 255; g[194] = 194; b[194] =  61;
	  r[195] = 255; g[195] = 195; b[195] =  60;
	  r[196] = 255; g[196] = 196; b[196] =  59;
	  r[197] = 255; g[197] = 197; b[197] =  58;
	  r[198] = 255; g[198] = 198; b[198] =  57;
	  r[199] = 255; g[199] = 199; b[199] =  56;
	  r[200] = 255; g[200] = 200; b[200] =  55;
	  r[201] = 255; g[201] = 201; b[201] =  54;
	  r[202] = 255; g[202] = 202; b[202] =  53;
	  r[203] = 255; g[203] = 203; b[203] =  52;
	  r[204] = 255; g[204] = 204; b[204] =  51;
	  r[205] = 255; g[205] = 205; b[205] =  50;
	  r[206] = 255; g[206] = 206; b[206] =  49;
	  r[207] = 255; g[207] = 207; b[207] =  48;
	  r[208] = 255; g[208] = 208; b[208] =  47;
	  r[209] = 255; g[209] = 209; b[209] =  46;
	  r[210] = 255; g[210] = 210; b[210] =  45;
	  r[211] = 255; g[211] = 211; b[211] =  44;
	  r[212] = 255; g[212] = 212; b[212] =  43;
	  r[213] = 255; g[213] = 213; b[213] =  42;
	  r[214] = 255; g[214] = 214; b[214] =  41;
	  r[215] = 255; g[215] = 215; b[215] =  40;
	  r[216] = 255; g[216] = 216; b[216] =  39;
	  r[217] = 255; g[217] = 217; b[217] =  38;
	  r[218] = 255; g[218] = 218; b[218] =  37;
	  r[219] = 255; g[219] = 219; b[219] =  36;
	  r[220] = 255; g[220] = 220; b[220] =  35;
	  r[221] = 255; g[221] = 221; b[221] =  34;
	  r[222] = 255; g[222] = 222; b[222] =  33;
	  r[223] = 255; g[223] = 223; b[223] =  32;
	  r[224] = 255; g[224] = 224; b[224] =  31;
	  r[225] = 255; g[225] = 225; b[225] =  30;
	  r[226] = 255; g[226] = 226; b[226] =  29;
	  r[227] = 255; g[227] = 227; b[227] =  28;
	  r[228] = 255; g[228] = 228; b[228] =  27;
	  r[229] = 255; g[229] = 229; b[229] =  26;
	  r[230] = 255; g[230] = 230; b[230] =  25;
	  r[231] = 255; g[231] = 231; b[231] =  24;
	  r[232] = 255; g[232] = 232; b[232] =  23;
	  r[233] = 255; g[233] = 233; b[233] =  22;
	  r[234] = 255; g[234] = 234; b[234] =  21;
	  r[235] = 255; g[235] = 235; b[235] =  20;
	  r[236] = 255; g[236] = 236; b[236] =  19;
	  r[237] = 255; g[237] = 237; b[237] =  18;
	  r[238] = 255; g[238] = 238; b[238] =  17;
	  r[239] = 255; g[239] = 239; b[239] =  16;
	  r[240] = 255; g[240] = 240; b[240] =  15;
	  r[241] = 255; g[241] = 241; b[241] =  14;
	  r[242] = 255; g[242] = 242; b[242] =  13;
	  r[243] = 255; g[243] = 243; b[243] =  12;
	  r[244] = 255; g[244] = 244; b[244] =  11;
	  r[245] = 255; g[245] = 245; b[245] =  10;
	  r[246] = 255; g[246] = 246; b[246] =   9;
	  r[247] = 255; g[247] = 247; b[247] =   8;
	  r[248] = 255; g[248] = 248; b[248] =   7;
	  r[249] = 255; g[249] = 249; b[249] =   6;
	  r[250] = 255; g[250] = 250; b[250] =   5;
	  r[251] = 255; g[251] = 251; b[251] =   4;
	  r[252] = 255; g[252] = 252; b[252] =   3;
	  r[253] = 255; g[253] = 253; b[253] =   2;
	  r[254] = 255; g[254] = 254; b[254] =   1;
	  r[255] = 255; g[255] = 255; b[255] =   0;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_SUMMER)
    {
      /***********************************************************************/

      /***** Summer palette **************************************************/

      if (colors == 256)
	{
	  /* Colormap from matlab */

	  r[  0] =   0; g[  0] = 128; b[  0] = 102;
	  r[  1] =   1; g[  1] = 128; b[  1] = 102;
	  r[  2] =   2; g[  2] = 128; b[  2] = 102;
	  r[  3] =   3; g[  3] = 129; b[  3] = 102;
	  r[  4] =   4; g[  4] = 130; b[  4] = 102;
	  r[  5] =   5; g[  5] = 130; b[  5] = 102;
	  r[  6] =   6; g[  6] = 130; b[  6] = 102;
	  r[  7] =   7; g[  7] = 131; b[  7] = 102;
	  r[  8] =   8; g[  8] = 132; b[  8] = 102;
	  r[  9] =   9; g[  9] = 132; b[  9] = 102;
	  r[ 10] =  10; g[ 10] = 132; b[ 10] = 102;
	  r[ 11] =  11; g[ 11] = 133; b[ 11] = 102;
	  r[ 12] =  12; g[ 12] = 134; b[ 12] = 102;
	  r[ 13] =  13; g[ 13] = 134; b[ 13] = 102;
	  r[ 14] =  14; g[ 14] = 134; b[ 14] = 102;
	  r[ 15] =  15; g[ 15] = 135; b[ 15] = 102;
	  r[ 16] =  16; g[ 16] = 136; b[ 16] = 102;
	  r[ 17] =  17; g[ 17] = 136; b[ 17] = 102;
	  r[ 18] =  18; g[ 18] = 136; b[ 18] = 102;
	  r[ 19] =  19; g[ 19] = 137; b[ 19] = 102;
	  r[ 20] =  20; g[ 20] = 138; b[ 20] = 102;
	  r[ 21] =  21; g[ 21] = 138; b[ 21] = 102;
	  r[ 22] =  22; g[ 22] = 138; b[ 22] = 102;
	  r[ 23] =  23; g[ 23] = 139; b[ 23] = 102;
	  r[ 24] =  24; g[ 24] = 140; b[ 24] = 102;
	  r[ 25] =  25; g[ 25] = 140; b[ 25] = 102;
	  r[ 26] =  26; g[ 26] = 140; b[ 26] = 102;
	  r[ 27] =  27; g[ 27] = 141; b[ 27] = 102;
	  r[ 28] =  28; g[ 28] = 142; b[ 28] = 102;
	  r[ 29] =  29; g[ 29] = 142; b[ 29] = 102;
	  r[ 30] =  30; g[ 30] = 142; b[ 30] = 102;
	  r[ 31] =  31; g[ 31] = 143; b[ 31] = 102;
	  r[ 32] =  32; g[ 32] = 144; b[ 32] = 102;
	  r[ 33] =  33; g[ 33] = 144; b[ 33] = 102;
	  r[ 34] =  34; g[ 34] = 144; b[ 34] = 102;
	  r[ 35] =  35; g[ 35] = 145; b[ 35] = 102;
	  r[ 36] =  36; g[ 36] = 146; b[ 36] = 102;
	  r[ 37] =  37; g[ 37] = 146; b[ 37] = 102;
	  r[ 38] =  38; g[ 38] = 146; b[ 38] = 102;
	  r[ 39] =  39; g[ 39] = 147; b[ 39] = 102;
	  r[ 40] =  40; g[ 40] = 147; b[ 40] = 102;
	  r[ 41] =  41; g[ 41] = 148; b[ 41] = 102;
	  r[ 42] =  42; g[ 42] = 148; b[ 42] = 102;
	  r[ 43] =  43; g[ 43] = 149; b[ 43] = 102;
	  r[ 44] =  44; g[ 44] = 150; b[ 44] = 102;
	  r[ 45] =  45; g[ 45] = 150; b[ 45] = 102;
	  r[ 46] =  46; g[ 46] = 150; b[ 46] = 102;
	  r[ 47] =  47; g[ 47] = 151; b[ 47] = 102;
	  r[ 48] =  48; g[ 48] = 152; b[ 48] = 102;
	  r[ 49] =  49; g[ 49] = 152; b[ 49] = 102;
	  r[ 50] =  50; g[ 50] = 152; b[ 50] = 102;
	  r[ 51] =  51; g[ 51] = 153; b[ 51] = 102;
	  r[ 52] =  52; g[ 52] = 154; b[ 52] = 102;
	  r[ 53] =  53; g[ 53] = 154; b[ 53] = 102;
	  r[ 54] =  54; g[ 54] = 154; b[ 54] = 102;
	  r[ 55] =  55; g[ 55] = 155; b[ 55] = 102;
	  r[ 56] =  56; g[ 56] = 156; b[ 56] = 102;
	  r[ 57] =  57; g[ 57] = 156; b[ 57] = 102;
	  r[ 58] =  58; g[ 58] = 156; b[ 58] = 102;
	  r[ 59] =  59; g[ 59] = 157; b[ 59] = 102;
	  r[ 60] =  60; g[ 60] = 158; b[ 60] = 102;
	  r[ 61] =  61; g[ 61] = 158; b[ 61] = 102;
	  r[ 62] =  62; g[ 62] = 158; b[ 62] = 102;
	  r[ 63] =  63; g[ 63] = 159; b[ 63] = 102;
	  r[ 64] =  64; g[ 64] = 160; b[ 64] = 102;
	  r[ 65] =  65; g[ 65] = 160; b[ 65] = 102;
	  r[ 66] =  66; g[ 66] = 160; b[ 66] = 102;
	  r[ 67] =  67; g[ 67] = 161; b[ 67] = 102;
	  r[ 68] =  68; g[ 68] = 162; b[ 68] = 102;
	  r[ 69] =  69; g[ 69] = 162; b[ 69] = 102;
	  r[ 70] =  70; g[ 70] = 162; b[ 70] = 102;
	  r[ 71] =  71; g[ 71] = 163; b[ 71] = 102;
	  r[ 72] =  72; g[ 72] = 163; b[ 72] = 102;
	  r[ 73] =  73; g[ 73] = 164; b[ 73] = 102;
	  r[ 74] =  74; g[ 74] = 164; b[ 74] = 102;
	  r[ 75] =  75; g[ 75] = 165; b[ 75] = 102;
	  r[ 76] =  76; g[ 76] = 166; b[ 76] = 102;
	  r[ 77] =  77; g[ 77] = 166; b[ 77] = 102;
	  r[ 78] =  78; g[ 78] = 166; b[ 78] = 102;
	  r[ 79] =  79; g[ 79] = 167; b[ 79] = 102;
	  r[ 80] =  80; g[ 80] = 168; b[ 80] = 102;
	  r[ 81] =  81; g[ 81] = 168; b[ 81] = 102;
	  r[ 82] =  82; g[ 82] = 168; b[ 82] = 102;
	  r[ 83] =  83; g[ 83] = 169; b[ 83] = 102;
	  r[ 84] =  84; g[ 84] = 170; b[ 84] = 102;
	  r[ 85] =  85; g[ 85] = 170; b[ 85] = 102;
	  r[ 86] =  86; g[ 86] = 171; b[ 86] = 102;
	  r[ 87] =  87; g[ 87] = 171; b[ 87] = 102;
	  r[ 88] =  88; g[ 88] = 172; b[ 88] = 102;
	  r[ 89] =  89; g[ 89] = 172; b[ 89] = 102;
	  r[ 90] =  90; g[ 90] = 172; b[ 90] = 102;
	  r[ 91] =  91; g[ 91] = 173; b[ 91] = 102;
	  r[ 92] =  92; g[ 92] = 174; b[ 92] = 102;
	  r[ 93] =  93; g[ 93] = 174; b[ 93] = 102;
	  r[ 94] =  94; g[ 94] = 174; b[ 94] = 102;
	  r[ 95] =  95; g[ 95] = 175; b[ 95] = 102;
	  r[ 96] =  96; g[ 96] = 176; b[ 96] = 102;
	  r[ 97] =  97; g[ 97] = 176; b[ 97] = 102;
	  r[ 98] =  98; g[ 98] = 176; b[ 98] = 102;
	  r[ 99] =  99; g[ 99] = 177; b[ 99] = 102;
	  r[100] = 100; g[100] = 178; b[100] = 102;
	  r[101] = 101; g[101] = 178; b[101] = 102;
	  r[102] = 102; g[102] = 178; b[102] = 102;
	  r[103] = 103; g[103] = 179; b[103] = 102;
	  r[104] = 104; g[104] = 179; b[104] = 102;
	  r[105] = 105; g[105] = 180; b[105] = 102;
	  r[106] = 106; g[106] = 180; b[106] = 102;
	  r[107] = 107; g[107] = 181; b[107] = 102;
	  r[108] = 108; g[108] = 182; b[108] = 102;
	  r[109] = 109; g[109] = 182; b[109] = 102;
	  r[110] = 110; g[110] = 182; b[110] = 102;
	  r[111] = 111; g[111] = 183; b[111] = 102;
	  r[112] = 112; g[112] = 184; b[112] = 102;
	  r[113] = 113; g[113] = 184; b[113] = 102;
	  r[114] = 114; g[114] = 184; b[114] = 102;
	  r[115] = 115; g[115] = 185; b[115] = 102;
	  r[116] = 116; g[116] = 186; b[116] = 102;
	  r[117] = 117; g[117] = 186; b[117] = 102;
	  r[118] = 118; g[118] = 187; b[118] = 102;
	  r[119] = 119; g[119] = 187; b[119] = 102;
	  r[120] = 120; g[120] = 188; b[120] = 102;
	  r[121] = 121; g[121] = 188; b[121] = 102;
	  r[122] = 122; g[122] = 188; b[122] = 102;
	  r[123] = 123; g[123] = 189; b[123] = 102;
	  r[124] = 124; g[124] = 190; b[124] = 102;
	  r[125] = 125; g[125] = 190; b[125] = 102;
	  r[126] = 126; g[126] = 190; b[126] = 102;
	  r[127] = 127; g[127] = 191; b[127] = 102;
	  r[128] = 128; g[128] = 192; b[128] = 102;
	  r[129] = 129; g[129] = 192; b[129] = 102;
	  r[130] = 130; g[130] = 192; b[130] = 102;
	  r[131] = 131; g[131] = 193; b[131] = 102;
	  r[132] = 132; g[132] = 194; b[132] = 102;
	  r[133] = 133; g[133] = 194; b[133] = 102;
	  r[134] = 134; g[134] = 194; b[134] = 102;
	  r[135] = 135; g[135] = 195; b[135] = 102;
	  r[136] = 136; g[136] = 195; b[136] = 102;
	  r[137] = 137; g[137] = 196; b[137] = 102;
	  r[138] = 138; g[138] = 196; b[138] = 102;
	  r[139] = 139; g[139] = 197; b[139] = 102;
	  r[140] = 140; g[140] = 198; b[140] = 102;
	  r[141] = 141; g[141] = 198; b[141] = 102;
	  r[142] = 142; g[142] = 198; b[142] = 102;
	  r[143] = 143; g[143] = 199; b[143] = 102;
	  r[144] = 144; g[144] = 200; b[144] = 102;
	  r[145] = 145; g[145] = 200; b[145] = 102;
	  r[146] = 146; g[146] = 200; b[146] = 102;
	  r[147] = 147; g[147] = 201; b[147] = 102;
	  r[148] = 148; g[148] = 202; b[148] = 102;
	  r[149] = 149; g[149] = 202; b[149] = 102;
	  r[150] = 150; g[150] = 203; b[150] = 102;
	  r[151] = 151; g[151] = 203; b[151] = 102;
	  r[152] = 152; g[152] = 204; b[152] = 102;
	  r[153] = 153; g[153] = 204; b[153] = 102;
	  r[154] = 154; g[154] = 204; b[154] = 102;
	  r[155] = 155; g[155] = 205; b[155] = 102;
	  r[156] = 156; g[156] = 206; b[156] = 102;
	  r[157] = 157; g[157] = 206; b[157] = 102;
	  r[158] = 158; g[158] = 206; b[158] = 102;
	  r[159] = 159; g[159] = 207; b[159] = 102;
	  r[160] = 160; g[160] = 208; b[160] = 102;
	  r[161] = 161; g[161] = 208; b[161] = 102;
	  r[162] = 162; g[162] = 208; b[162] = 102;
	  r[163] = 163; g[163] = 209; b[163] = 102;
	  r[164] = 164; g[164] = 210; b[164] = 102;
	  r[165] = 165; g[165] = 210; b[165] = 102;
	  r[166] = 166; g[166] = 210; b[166] = 102;
	  r[167] = 167; g[167] = 211; b[167] = 102;
	  r[168] = 168; g[168] = 211; b[168] = 102;
	  r[169] = 169; g[169] = 212; b[169] = 102;
	  r[170] = 170; g[170] = 212; b[170] = 102;
	  r[171] = 171; g[171] = 213; b[171] = 102;
	  r[172] = 172; g[172] = 214; b[172] = 102;
	  r[173] = 173; g[173] = 214; b[173] = 102;
	  r[174] = 174; g[174] = 214; b[174] = 102;
	  r[175] = 175; g[175] = 215; b[175] = 102;
	  r[176] = 176; g[176] = 216; b[176] = 102;
	  r[177] = 177; g[177] = 216; b[177] = 102;
	  r[178] = 178; g[178] = 216; b[178] = 102;
	  r[179] = 179; g[179] = 217; b[179] = 102;
	  r[180] = 180; g[180] = 218; b[180] = 102;
	  r[181] = 181; g[181] = 218; b[181] = 102;
	  r[182] = 182; g[182] = 219; b[182] = 102;
	  r[183] = 183; g[183] = 219; b[183] = 102;
	  r[184] = 184; g[184] = 220; b[184] = 102;
	  r[185] = 185; g[185] = 220; b[185] = 102;
	  r[186] = 186; g[186] = 220; b[186] = 102;
	  r[187] = 187; g[187] = 221; b[187] = 102;
	  r[188] = 188; g[188] = 222; b[188] = 102;
	  r[189] = 189; g[189] = 222; b[189] = 102;
	  r[190] = 190; g[190] = 222; b[190] = 102;
	  r[191] = 191; g[191] = 223; b[191] = 102;
	  r[192] = 192; g[192] = 224; b[192] = 102;
	  r[193] = 193; g[193] = 224; b[193] = 102;
	  r[194] = 194; g[194] = 224; b[194] = 102;
	  r[195] = 195; g[195] = 225; b[195] = 102;
	  r[196] = 196; g[196] = 226; b[196] = 102;
	  r[197] = 197; g[197] = 226; b[197] = 102;
	  r[198] = 198; g[198] = 226; b[198] = 102;
	  r[199] = 199; g[199] = 227; b[199] = 102;
	  r[200] = 200; g[200] = 227; b[200] = 102;
	  r[201] = 201; g[201] = 228; b[201] = 102;
	  r[202] = 202; g[202] = 228; b[202] = 102;
	  r[203] = 203; g[203] = 229; b[203] = 102;
	  r[204] = 204; g[204] = 230; b[204] = 102;
	  r[205] = 205; g[205] = 230; b[205] = 102;
	  r[206] = 206; g[206] = 230; b[206] = 102;
	  r[207] = 207; g[207] = 231; b[207] = 102;
	  r[208] = 208; g[208] = 232; b[208] = 102;
	  r[209] = 209; g[209] = 232; b[209] = 102;
	  r[210] = 210; g[210] = 232; b[210] = 102;
	  r[211] = 211; g[211] = 233; b[211] = 102;
	  r[212] = 212; g[212] = 234; b[212] = 102;
	  r[213] = 213; g[213] = 234; b[213] = 102;
	  r[214] = 214; g[214] = 235; b[214] = 102;
	  r[215] = 215; g[215] = 235; b[215] = 102;
	  r[216] = 216; g[216] = 236; b[216] = 102;
	  r[217] = 217; g[217] = 236; b[217] = 102;
	  r[218] = 218; g[218] = 236; b[218] = 102;
	  r[219] = 219; g[219] = 237; b[219] = 102;
	  r[220] = 220; g[220] = 238; b[220] = 102;
	  r[221] = 221; g[221] = 238; b[221] = 102;
	  r[222] = 222; g[222] = 238; b[222] = 102;
	  r[223] = 223; g[223] = 239; b[223] = 102;
	  r[224] = 224; g[224] = 240; b[224] = 102;
	  r[225] = 225; g[225] = 240; b[225] = 102;
	  r[226] = 226; g[226] = 240; b[226] = 102;
	  r[227] = 227; g[227] = 241; b[227] = 102;
	  r[228] = 228; g[228] = 242; b[228] = 102;
	  r[229] = 229; g[229] = 242; b[229] = 102;
	  r[230] = 230; g[230] = 242; b[230] = 102;
	  r[231] = 231; g[231] = 243; b[231] = 102;
	  r[232] = 232; g[232] = 243; b[232] = 102;
	  r[233] = 233; g[233] = 244; b[233] = 102;
	  r[234] = 234; g[234] = 244; b[234] = 102;
	  r[235] = 235; g[235] = 245; b[235] = 102;
	  r[236] = 236; g[236] = 246; b[236] = 102;
	  r[237] = 237; g[237] = 246; b[237] = 102;
	  r[238] = 238; g[238] = 246; b[238] = 102;
	  r[239] = 239; g[239] = 247; b[239] = 102;
	  r[240] = 240; g[240] = 248; b[240] = 102;
	  r[241] = 241; g[241] = 248; b[241] = 102;
	  r[242] = 242; g[242] = 248; b[242] = 102;
	  r[243] = 243; g[243] = 249; b[243] = 102;
	  r[244] = 244; g[244] = 250; b[244] = 102;
	  r[245] = 245; g[245] = 250; b[245] = 102;
	  r[246] = 246; g[246] = 251; b[246] = 102;
	  r[247] = 247; g[247] = 251; b[247] = 102;
	  r[248] = 248; g[248] = 252; b[248] = 102;
	  r[249] = 249; g[249] = 252; b[249] = 102;
	  r[250] = 250; g[250] = 252; b[250] = 102;
	  r[251] = 251; g[251] = 253; b[251] = 102;
	  r[252] = 252; g[252] = 254; b[252] = 102;
	  r[253] = 253; g[253] = 254; b[253] = 102;
	  r[254] = 254; g[254] = 254; b[254] = 102;
	  r[255] = 255; g[255] = 255; b[255] = 102;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_AUTUMN)
    {
      /***********************************************************************/

      /***** Autumn palette **************************************************/

      if (colors == 256)
	{
	  /* Colormap from matlab */

	  r[  0] = 255; g[  0] =   0; b[  0] =   0;
	  r[  1] = 255; g[  1] =   1; b[  1] =   0;
	  r[  2] = 255; g[  2] =   2; b[  2] =   0;
	  r[  3] = 255; g[  3] =   3; b[  3] =   0;
	  r[  4] = 255; g[  4] =   4; b[  4] =   0;
	  r[  5] = 255; g[  5] =   5; b[  5] =   0;
	  r[  6] = 255; g[  6] =   6; b[  6] =   0;
	  r[  7] = 255; g[  7] =   7; b[  7] =   0;
	  r[  8] = 255; g[  8] =   8; b[  8] =   0;
	  r[  9] = 255; g[  9] =   9; b[  9] =   0;
	  r[ 10] = 255; g[ 10] =  10; b[ 10] =   0;
	  r[ 11] = 255; g[ 11] =  11; b[ 11] =   0;
	  r[ 12] = 255; g[ 12] =  12; b[ 12] =   0;
	  r[ 13] = 255; g[ 13] =  13; b[ 13] =   0;
	  r[ 14] = 255; g[ 14] =  14; b[ 14] =   0;
	  r[ 15] = 255; g[ 15] =  15; b[ 15] =   0;
	  r[ 16] = 255; g[ 16] =  16; b[ 16] =   0;
	  r[ 17] = 255; g[ 17] =  17; b[ 17] =   0;
	  r[ 18] = 255; g[ 18] =  18; b[ 18] =   0;
	  r[ 19] = 255; g[ 19] =  19; b[ 19] =   0;
	  r[ 20] = 255; g[ 20] =  20; b[ 20] =   0;
	  r[ 21] = 255; g[ 21] =  21; b[ 21] =   0;
	  r[ 22] = 255; g[ 22] =  22; b[ 22] =   0;
	  r[ 23] = 255; g[ 23] =  23; b[ 23] =   0;
	  r[ 24] = 255; g[ 24] =  24; b[ 24] =   0;
	  r[ 25] = 255; g[ 25] =  25; b[ 25] =   0;
	  r[ 26] = 255; g[ 26] =  26; b[ 26] =   0;
	  r[ 27] = 255; g[ 27] =  27; b[ 27] =   0;
	  r[ 28] = 255; g[ 28] =  28; b[ 28] =   0;
	  r[ 29] = 255; g[ 29] =  29; b[ 29] =   0;
	  r[ 30] = 255; g[ 30] =  30; b[ 30] =   0;
	  r[ 31] = 255; g[ 31] =  31; b[ 31] =   0;
	  r[ 32] = 255; g[ 32] =  32; b[ 32] =   0;
	  r[ 33] = 255; g[ 33] =  33; b[ 33] =   0;
	  r[ 34] = 255; g[ 34] =  34; b[ 34] =   0;
	  r[ 35] = 255; g[ 35] =  35; b[ 35] =   0;
	  r[ 36] = 255; g[ 36] =  36; b[ 36] =   0;
	  r[ 37] = 255; g[ 37] =  37; b[ 37] =   0;
	  r[ 38] = 255; g[ 38] =  38; b[ 38] =   0;
	  r[ 39] = 255; g[ 39] =  39; b[ 39] =   0;
	  r[ 40] = 255; g[ 40] =  40; b[ 40] =   0;
	  r[ 41] = 255; g[ 41] =  41; b[ 41] =   0;
	  r[ 42] = 255; g[ 42] =  42; b[ 42] =   0;
	  r[ 43] = 255; g[ 43] =  43; b[ 43] =   0;
	  r[ 44] = 255; g[ 44] =  44; b[ 44] =   0;
	  r[ 45] = 255; g[ 45] =  45; b[ 45] =   0;
	  r[ 46] = 255; g[ 46] =  46; b[ 46] =   0;
	  r[ 47] = 255; g[ 47] =  47; b[ 47] =   0;
	  r[ 48] = 255; g[ 48] =  48; b[ 48] =   0;
	  r[ 49] = 255; g[ 49] =  49; b[ 49] =   0;
	  r[ 50] = 255; g[ 50] =  50; b[ 50] =   0;
	  r[ 51] = 255; g[ 51] =  51; b[ 51] =   0;
	  r[ 52] = 255; g[ 52] =  52; b[ 52] =   0;
	  r[ 53] = 255; g[ 53] =  53; b[ 53] =   0;
	  r[ 54] = 255; g[ 54] =  54; b[ 54] =   0;
	  r[ 55] = 255; g[ 55] =  55; b[ 55] =   0;
	  r[ 56] = 255; g[ 56] =  56; b[ 56] =   0;
	  r[ 57] = 255; g[ 57] =  57; b[ 57] =   0;
	  r[ 58] = 255; g[ 58] =  58; b[ 58] =   0;
	  r[ 59] = 255; g[ 59] =  59; b[ 59] =   0;
	  r[ 60] = 255; g[ 60] =  60; b[ 60] =   0;
	  r[ 61] = 255; g[ 61] =  61; b[ 61] =   0;
	  r[ 62] = 255; g[ 62] =  62; b[ 62] =   0;
	  r[ 63] = 255; g[ 63] =  63; b[ 63] =   0;
	  r[ 64] = 255; g[ 64] =  64; b[ 64] =   0;
	  r[ 65] = 255; g[ 65] =  65; b[ 65] =   0;
	  r[ 66] = 255; g[ 66] =  66; b[ 66] =   0;
	  r[ 67] = 255; g[ 67] =  67; b[ 67] =   0;
	  r[ 68] = 255; g[ 68] =  68; b[ 68] =   0;
	  r[ 69] = 255; g[ 69] =  69; b[ 69] =   0;
	  r[ 70] = 255; g[ 70] =  70; b[ 70] =   0;
	  r[ 71] = 255; g[ 71] =  71; b[ 71] =   0;
	  r[ 72] = 255; g[ 72] =  72; b[ 72] =   0;
	  r[ 73] = 255; g[ 73] =  73; b[ 73] =   0;
	  r[ 74] = 255; g[ 74] =  74; b[ 74] =   0;
	  r[ 75] = 255; g[ 75] =  75; b[ 75] =   0;
	  r[ 76] = 255; g[ 76] =  76; b[ 76] =   0;
	  r[ 77] = 255; g[ 77] =  77; b[ 77] =   0;
	  r[ 78] = 255; g[ 78] =  78; b[ 78] =   0;
	  r[ 79] = 255; g[ 79] =  79; b[ 79] =   0;
	  r[ 80] = 255; g[ 80] =  80; b[ 80] =   0;
	  r[ 81] = 255; g[ 81] =  81; b[ 81] =   0;
	  r[ 82] = 255; g[ 82] =  82; b[ 82] =   0;
	  r[ 83] = 255; g[ 83] =  83; b[ 83] =   0;
	  r[ 84] = 255; g[ 84] =  84; b[ 84] =   0;
	  r[ 85] = 255; g[ 85] =  85; b[ 85] =   0;
	  r[ 86] = 255; g[ 86] =  86; b[ 86] =   0;
	  r[ 87] = 255; g[ 87] =  87; b[ 87] =   0;
	  r[ 88] = 255; g[ 88] =  88; b[ 88] =   0;
	  r[ 89] = 255; g[ 89] =  89; b[ 89] =   0;
	  r[ 90] = 255; g[ 90] =  90; b[ 90] =   0;
	  r[ 91] = 255; g[ 91] =  91; b[ 91] =   0;
	  r[ 92] = 255; g[ 92] =  92; b[ 92] =   0;
	  r[ 93] = 255; g[ 93] =  93; b[ 93] =   0;
	  r[ 94] = 255; g[ 94] =  94; b[ 94] =   0;
	  r[ 95] = 255; g[ 95] =  95; b[ 95] =   0;
	  r[ 96] = 255; g[ 96] =  96; b[ 96] =   0;
	  r[ 97] = 255; g[ 97] =  97; b[ 97] =   0;
	  r[ 98] = 255; g[ 98] =  98; b[ 98] =   0;
	  r[ 99] = 255; g[ 99] =  99; b[ 99] =   0;
	  r[100] = 255; g[100] = 100; b[100] =   0;
	  r[101] = 255; g[101] = 101; b[101] =   0;
	  r[102] = 255; g[102] = 102; b[102] =   0;
	  r[103] = 255; g[103] = 103; b[103] =   0;
	  r[104] = 255; g[104] = 104; b[104] =   0;
	  r[105] = 255; g[105] = 105; b[105] =   0;
	  r[106] = 255; g[106] = 106; b[106] =   0;
	  r[107] = 255; g[107] = 107; b[107] =   0;
	  r[108] = 255; g[108] = 108; b[108] =   0;
	  r[109] = 255; g[109] = 109; b[109] =   0;
	  r[110] = 255; g[110] = 110; b[110] =   0;
	  r[111] = 255; g[111] = 111; b[111] =   0;
	  r[112] = 255; g[112] = 112; b[112] =   0;
	  r[113] = 255; g[113] = 113; b[113] =   0;
	  r[114] = 255; g[114] = 114; b[114] =   0;
	  r[115] = 255; g[115] = 115; b[115] =   0;
	  r[116] = 255; g[116] = 116; b[116] =   0;
	  r[117] = 255; g[117] = 117; b[117] =   0;
	  r[118] = 255; g[118] = 118; b[118] =   0;
	  r[119] = 255; g[119] = 119; b[119] =   0;
	  r[120] = 255; g[120] = 120; b[120] =   0;
	  r[121] = 255; g[121] = 121; b[121] =   0;
	  r[122] = 255; g[122] = 122; b[122] =   0;
	  r[123] = 255; g[123] = 123; b[123] =   0;
	  r[124] = 255; g[124] = 124; b[124] =   0;
	  r[125] = 255; g[125] = 125; b[125] =   0;
	  r[126] = 255; g[126] = 126; b[126] =   0;
	  r[127] = 255; g[127] = 127; b[127] =   0;
	  r[128] = 255; g[128] = 128; b[128] =   0;
	  r[129] = 255; g[129] = 129; b[129] =   0;
	  r[130] = 255; g[130] = 130; b[130] =   0;
	  r[131] = 255; g[131] = 131; b[131] =   0;
	  r[132] = 255; g[132] = 132; b[132] =   0;
	  r[133] = 255; g[133] = 133; b[133] =   0;
	  r[134] = 255; g[134] = 134; b[134] =   0;
	  r[135] = 255; g[135] = 135; b[135] =   0;
	  r[136] = 255; g[136] = 136; b[136] =   0;
	  r[137] = 255; g[137] = 137; b[137] =   0;
	  r[138] = 255; g[138] = 138; b[138] =   0;
	  r[139] = 255; g[139] = 139; b[139] =   0;
	  r[140] = 255; g[140] = 140; b[140] =   0;
	  r[141] = 255; g[141] = 141; b[141] =   0;
	  r[142] = 255; g[142] = 142; b[142] =   0;
	  r[143] = 255; g[143] = 143; b[143] =   0;
	  r[144] = 255; g[144] = 144; b[144] =   0;
	  r[145] = 255; g[145] = 145; b[145] =   0;
	  r[146] = 255; g[146] = 146; b[146] =   0;
	  r[147] = 255; g[147] = 147; b[147] =   0;
	  r[148] = 255; g[148] = 148; b[148] =   0;
	  r[149] = 255; g[149] = 149; b[149] =   0;
	  r[150] = 255; g[150] = 150; b[150] =   0;
	  r[151] = 255; g[151] = 151; b[151] =   0;
	  r[152] = 255; g[152] = 152; b[152] =   0;
	  r[153] = 255; g[153] = 153; b[153] =   0;
	  r[154] = 255; g[154] = 154; b[154] =   0;
	  r[155] = 255; g[155] = 155; b[155] =   0;
	  r[156] = 255; g[156] = 156; b[156] =   0;
	  r[157] = 255; g[157] = 157; b[157] =   0;
	  r[158] = 255; g[158] = 158; b[158] =   0;
	  r[159] = 255; g[159] = 159; b[159] =   0;
	  r[160] = 255; g[160] = 160; b[160] =   0;
	  r[161] = 255; g[161] = 161; b[161] =   0;
	  r[162] = 255; g[162] = 162; b[162] =   0;
	  r[163] = 255; g[163] = 163; b[163] =   0;
	  r[164] = 255; g[164] = 164; b[164] =   0;
	  r[165] = 255; g[165] = 165; b[165] =   0;
	  r[166] = 255; g[166] = 166; b[166] =   0;
	  r[167] = 255; g[167] = 167; b[167] =   0;
	  r[168] = 255; g[168] = 168; b[168] =   0;
	  r[169] = 255; g[169] = 169; b[169] =   0;
	  r[170] = 255; g[170] = 170; b[170] =   0;
	  r[171] = 255; g[171] = 171; b[171] =   0;
	  r[172] = 255; g[172] = 172; b[172] =   0;
	  r[173] = 255; g[173] = 173; b[173] =   0;
	  r[174] = 255; g[174] = 174; b[174] =   0;
	  r[175] = 255; g[175] = 175; b[175] =   0;
	  r[176] = 255; g[176] = 176; b[176] =   0;
	  r[177] = 255; g[177] = 177; b[177] =   0;
	  r[178] = 255; g[178] = 178; b[178] =   0;
	  r[179] = 255; g[179] = 179; b[179] =   0;
	  r[180] = 255; g[180] = 180; b[180] =   0;
	  r[181] = 255; g[181] = 181; b[181] =   0;
	  r[182] = 255; g[182] = 182; b[182] =   0;
	  r[183] = 255; g[183] = 183; b[183] =   0;
	  r[184] = 255; g[184] = 184; b[184] =   0;
	  r[185] = 255; g[185] = 185; b[185] =   0;
	  r[186] = 255; g[186] = 186; b[186] =   0;
	  r[187] = 255; g[187] = 187; b[187] =   0;
	  r[188] = 255; g[188] = 188; b[188] =   0;
	  r[189] = 255; g[189] = 189; b[189] =   0;
	  r[190] = 255; g[190] = 190; b[190] =   0;
	  r[191] = 255; g[191] = 191; b[191] =   0;
	  r[192] = 255; g[192] = 192; b[192] =   0;
	  r[193] = 255; g[193] = 193; b[193] =   0;
	  r[194] = 255; g[194] = 194; b[194] =   0;
	  r[195] = 255; g[195] = 195; b[195] =   0;
	  r[196] = 255; g[196] = 196; b[196] =   0;
	  r[197] = 255; g[197] = 197; b[197] =   0;
	  r[198] = 255; g[198] = 198; b[198] =   0;
	  r[199] = 255; g[199] = 199; b[199] =   0;
	  r[200] = 255; g[200] = 200; b[200] =   0;
	  r[201] = 255; g[201] = 201; b[201] =   0;
	  r[202] = 255; g[202] = 202; b[202] =   0;
	  r[203] = 255; g[203] = 203; b[203] =   0;
	  r[204] = 255; g[204] = 204; b[204] =   0;
	  r[205] = 255; g[205] = 205; b[205] =   0;
	  r[206] = 255; g[206] = 206; b[206] =   0;
	  r[207] = 255; g[207] = 207; b[207] =   0;
	  r[208] = 255; g[208] = 208; b[208] =   0;
	  r[209] = 255; g[209] = 209; b[209] =   0;
	  r[210] = 255; g[210] = 210; b[210] =   0;
	  r[211] = 255; g[211] = 211; b[211] =   0;
	  r[212] = 255; g[212] = 212; b[212] =   0;
	  r[213] = 255; g[213] = 213; b[213] =   0;
	  r[214] = 255; g[214] = 214; b[214] =   0;
	  r[215] = 255; g[215] = 215; b[215] =   0;
	  r[216] = 255; g[216] = 216; b[216] =   0;
	  r[217] = 255; g[217] = 217; b[217] =   0;
	  r[218] = 255; g[218] = 218; b[218] =   0;
	  r[219] = 255; g[219] = 219; b[219] =   0;
	  r[220] = 255; g[220] = 220; b[220] =   0;
	  r[221] = 255; g[221] = 221; b[221] =   0;
	  r[222] = 255; g[222] = 222; b[222] =   0;
	  r[223] = 255; g[223] = 223; b[223] =   0;
	  r[224] = 255; g[224] = 224; b[224] =   0;
	  r[225] = 255; g[225] = 225; b[225] =   0;
	  r[226] = 255; g[226] = 226; b[226] =   0;
	  r[227] = 255; g[227] = 227; b[227] =   0;
	  r[228] = 255; g[228] = 228; b[228] =   0;
	  r[229] = 255; g[229] = 229; b[229] =   0;
	  r[230] = 255; g[230] = 230; b[230] =   0;
	  r[231] = 255; g[231] = 231; b[231] =   0;
	  r[232] = 255; g[232] = 232; b[232] =   0;
	  r[233] = 255; g[233] = 233; b[233] =   0;
	  r[234] = 255; g[234] = 234; b[234] =   0;
	  r[235] = 255; g[235] = 235; b[235] =   0;
	  r[236] = 255; g[236] = 236; b[236] =   0;
	  r[237] = 255; g[237] = 237; b[237] =   0;
	  r[238] = 255; g[238] = 238; b[238] =   0;
	  r[239] = 255; g[239] = 239; b[239] =   0;
	  r[240] = 255; g[240] = 240; b[240] =   0;
	  r[241] = 255; g[241] = 241; b[241] =   0;
	  r[242] = 255; g[242] = 242; b[242] =   0;
	  r[243] = 255; g[243] = 243; b[243] =   0;
	  r[244] = 255; g[244] = 244; b[244] =   0;
	  r[245] = 255; g[245] = 245; b[245] =   0;
	  r[246] = 255; g[246] = 246; b[246] =   0;
	  r[247] = 255; g[247] = 247; b[247] =   0;
	  r[248] = 255; g[248] = 248; b[248] =   0;
	  r[249] = 255; g[249] = 249; b[249] =   0;
	  r[250] = 255; g[250] = 250; b[250] =   0;
	  r[251] = 255; g[251] = 251; b[251] =   0;
	  r[252] = 255; g[252] = 252; b[252] =   0;
	  r[253] = 255; g[253] = 253; b[253] =   0;
	  r[254] = 255; g[254] = 254; b[254] =   0;
	  r[255] = 255; g[255] = 255; b[255] =   0;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_WINTER)
    {
      /***********************************************************************/

      /***** Winter palette **************************************************/

      if (colors == 256)
	{
	  /* Colormap from matlab */

	  r[  0] =   0; g[  0] =   0; b[  0] = 255;
	  r[  1] =   0; g[  1] =   1; b[  1] = 254;
	  r[  2] =   0; g[  2] =   2; b[  2] = 254;
	  r[  3] =   0; g[  3] =   3; b[  3] = 254;
	  r[  4] =   0; g[  4] =   4; b[  4] = 253;
	  r[  5] =   0; g[  5] =   5; b[  5] = 252;
	  r[  6] =   0; g[  6] =   6; b[  6] = 252;
	  r[  7] =   0; g[  7] =   7; b[  7] = 252;
	  r[  8] =   0; g[  8] =   8; b[  8] = 251;
	  r[  9] =   0; g[  9] =   9; b[  9] = 251;
	  r[ 10] =   0; g[ 10] =  10; b[ 10] = 250;
	  r[ 11] =   0; g[ 11] =  11; b[ 11] = 250;
	  r[ 12] =   0; g[ 12] =  12; b[ 12] = 249;
	  r[ 13] =   0; g[ 13] =  13; b[ 13] = 248;
	  r[ 14] =   0; g[ 14] =  14; b[ 14] = 248;
	  r[ 15] =   0; g[ 15] =  15; b[ 15] = 248;
	  r[ 16] =   0; g[ 16] =  16; b[ 16] = 247;
	  r[ 17] =   0; g[ 17] =  17; b[ 17] = 246;
	  r[ 18] =   0; g[ 18] =  18; b[ 18] = 246;
	  r[ 19] =   0; g[ 19] =  19; b[ 19] = 246;
	  r[ 20] =   0; g[ 20] =  20; b[ 20] = 245;
	  r[ 21] =   0; g[ 21] =  21; b[ 21] = 244;
	  r[ 22] =   0; g[ 22] =  22; b[ 22] = 244;
	  r[ 23] =   0; g[ 23] =  23; b[ 23] = 243;
	  r[ 24] =   0; g[ 24] =  24; b[ 24] = 243;
	  r[ 25] =   0; g[ 25] =  25; b[ 25] = 242;
	  r[ 26] =   0; g[ 26] =  26; b[ 26] = 242;
	  r[ 27] =   0; g[ 27] =  27; b[ 27] = 242;
	  r[ 28] =   0; g[ 28] =  28; b[ 28] = 241;
	  r[ 29] =   0; g[ 29] =  29; b[ 29] = 240;
	  r[ 30] =   0; g[ 30] =  30; b[ 30] = 240;
	  r[ 31] =   0; g[ 31] =  31; b[ 31] = 240;
	  r[ 32] =   0; g[ 32] =  32; b[ 32] = 239;
	  r[ 33] =   0; g[ 33] =  33; b[ 33] = 238;
	  r[ 34] =   0; g[ 34] =  34; b[ 34] = 238;
	  r[ 35] =   0; g[ 35] =  35; b[ 35] = 238;
	  r[ 36] =   0; g[ 36] =  36; b[ 36] = 237;
	  r[ 37] =   0; g[ 37] =  37; b[ 37] = 236;
	  r[ 38] =   0; g[ 38] =  38; b[ 38] = 236;
	  r[ 39] =   0; g[ 39] =  39; b[ 39] = 236;
	  r[ 40] =   0; g[ 40] =  40; b[ 40] = 235;
	  r[ 41] =   0; g[ 41] =  41; b[ 41] = 235;
	  r[ 42] =   0; g[ 42] =  42; b[ 42] = 234;
	  r[ 43] =   0; g[ 43] =  43; b[ 43] = 234;
	  r[ 44] =   0; g[ 44] =  44; b[ 44] = 233;
	  r[ 45] =   0; g[ 45] =  45; b[ 45] = 232;
	  r[ 46] =   0; g[ 46] =  46; b[ 46] = 232;
	  r[ 47] =   0; g[ 47] =  47; b[ 47] = 232;
	  r[ 48] =   0; g[ 48] =  48; b[ 48] = 231;
	  r[ 49] =   0; g[ 49] =  49; b[ 49] = 230;
	  r[ 50] =   0; g[ 50] =  50; b[ 50] = 230;
	  r[ 51] =   0; g[ 51] =  51; b[ 51] = 230;
	  r[ 52] =   0; g[ 52] =  52; b[ 52] = 229;
	  r[ 53] =   0; g[ 53] =  53; b[ 53] = 228;
	  r[ 54] =   0; g[ 54] =  54; b[ 54] = 228;
	  r[ 55] =   0; g[ 55] =  55; b[ 55] = 227;
	  r[ 56] =   0; g[ 56] =  56; b[ 56] = 227;
	  r[ 57] =   0; g[ 57] =  57; b[ 57] = 226;
	  r[ 58] =   0; g[ 58] =  58; b[ 58] = 226;
	  r[ 59] =   0; g[ 59] =  59; b[ 59] = 226;
	  r[ 60] =   0; g[ 60] =  60; b[ 60] = 225;
	  r[ 61] =   0; g[ 61] =  61; b[ 61] = 224;
	  r[ 62] =   0; g[ 62] =  62; b[ 62] = 224;
	  r[ 63] =   0; g[ 63] =  63; b[ 63] = 224;
	  r[ 64] =   0; g[ 64] =  64; b[ 64] = 223;
	  r[ 65] =   0; g[ 65] =  65; b[ 65] = 222;
	  r[ 66] =   0; g[ 66] =  66; b[ 66] = 222;
	  r[ 67] =   0; g[ 67] =  67; b[ 67] = 222;
	  r[ 68] =   0; g[ 68] =  68; b[ 68] = 221;
	  r[ 69] =   0; g[ 69] =  69; b[ 69] = 220;
	  r[ 70] =   0; g[ 70] =  70; b[ 70] = 220;
	  r[ 71] =   0; g[ 71] =  71; b[ 71] = 220;
	  r[ 72] =   0; g[ 72] =  72; b[ 72] = 219;
	  r[ 73] =   0; g[ 73] =  73; b[ 73] = 219;
	  r[ 74] =   0; g[ 74] =  74; b[ 74] = 218;
	  r[ 75] =   0; g[ 75] =  75; b[ 75] = 218;
	  r[ 76] =   0; g[ 76] =  76; b[ 76] = 217;
	  r[ 77] =   0; g[ 77] =  77; b[ 77] = 216;
	  r[ 78] =   0; g[ 78] =  78; b[ 78] = 216;
	  r[ 79] =   0; g[ 79] =  79; b[ 79] = 216;
	  r[ 80] =   0; g[ 80] =  80; b[ 80] = 215;
	  r[ 81] =   0; g[ 81] =  81; b[ 81] = 214;
	  r[ 82] =   0; g[ 82] =  82; b[ 82] = 214;
	  r[ 83] =   0; g[ 83] =  83; b[ 83] = 214;
	  r[ 84] =   0; g[ 84] =  84; b[ 84] = 213;
	  r[ 85] =   0; g[ 85] =  85; b[ 85] = 212;
	  r[ 86] =   0; g[ 86] =  86; b[ 86] = 212;
	  r[ 87] =   0; g[ 87] =  87; b[ 87] = 211;
	  r[ 88] =   0; g[ 88] =  88; b[ 88] = 211;
	  r[ 89] =   0; g[ 89] =  89; b[ 89] = 210;
	  r[ 90] =   0; g[ 90] =  90; b[ 90] = 210;
	  r[ 91] =   0; g[ 91] =  91; b[ 91] = 210;
	  r[ 92] =   0; g[ 92] =  92; b[ 92] = 209;
	  r[ 93] =   0; g[ 93] =  93; b[ 93] = 208;
	  r[ 94] =   0; g[ 94] =  94; b[ 94] = 208;
	  r[ 95] =   0; g[ 95] =  95; b[ 95] = 208;
	  r[ 96] =   0; g[ 96] =  96; b[ 96] = 207;
	  r[ 97] =   0; g[ 97] =  97; b[ 97] = 206;
	  r[ 98] =   0; g[ 98] =  98; b[ 98] = 206;
	  r[ 99] =   0; g[ 99] =  99; b[ 99] = 206;
	  r[100] =   0; g[100] = 100; b[100] = 205;
	  r[101] =   0; g[101] = 101; b[101] = 204;
	  r[102] =   0; g[102] = 102; b[102] = 204;
	  r[103] =   0; g[103] = 103; b[103] = 204;
	  r[104] =   0; g[104] = 104; b[104] = 203;
	  r[105] =   0; g[105] = 105; b[105] = 203;
	  r[106] =   0; g[106] = 106; b[106] = 202;
	  r[107] =   0; g[107] = 107; b[107] = 202;
	  r[108] =   0; g[108] = 108; b[108] = 201;
	  r[109] =   0; g[109] = 109; b[109] = 200;
	  r[110] =   0; g[110] = 110; b[110] = 200;
	  r[111] =   0; g[111] = 111; b[111] = 200;
	  r[112] =   0; g[112] = 112; b[112] = 199;
	  r[113] =   0; g[113] = 113; b[113] = 198;
	  r[114] =   0; g[114] = 114; b[114] = 198;
	  r[115] =   0; g[115] = 115; b[115] = 198;
	  r[116] =   0; g[116] = 116; b[116] = 197;
	  r[117] =   0; g[117] = 117; b[117] = 196;
	  r[118] =   0; g[118] = 118; b[118] = 196;
	  r[119] =   0; g[119] = 119; b[119] = 195;
	  r[120] =   0; g[120] = 120; b[120] = 195;
	  r[121] =   0; g[121] = 121; b[121] = 194;
	  r[122] =   0; g[122] = 122; b[122] = 194;
	  r[123] =   0; g[123] = 123; b[123] = 194;
	  r[124] =   0; g[124] = 124; b[124] = 193;
	  r[125] =   0; g[125] = 125; b[125] = 192;
	  r[126] =   0; g[126] = 126; b[126] = 192;
	  r[127] =   0; g[127] = 127; b[127] = 192;
	  r[128] =   0; g[128] = 128; b[128] = 191;
	  r[129] =   0; g[129] = 129; b[129] = 190;
	  r[130] =   0; g[130] = 130; b[130] = 190;
	  r[131] =   0; g[131] = 131; b[131] = 190;
	  r[132] =   0; g[132] = 132; b[132] = 189;
	  r[133] =   0; g[133] = 133; b[133] = 188;
	  r[134] =   0; g[134] = 134; b[134] = 188;
	  r[135] =   0; g[135] = 135; b[135] = 188;
	  r[136] =   0; g[136] = 136; b[136] = 187;
	  r[137] =   0; g[137] = 137; b[137] = 187;
	  r[138] =   0; g[138] = 138; b[138] = 186;
	  r[139] =   0; g[139] = 139; b[139] = 186;
	  r[140] =   0; g[140] = 140; b[140] = 185;
	  r[141] =   0; g[141] = 141; b[141] = 184;
	  r[142] =   0; g[142] = 142; b[142] = 184;
	  r[143] =   0; g[143] = 143; b[143] = 184;
	  r[144] =   0; g[144] = 144; b[144] = 183;
	  r[145] =   0; g[145] = 145; b[145] = 182;
	  r[146] =   0; g[146] = 146; b[146] = 182;
	  r[147] =   0; g[147] = 147; b[147] = 182;
	  r[148] =   0; g[148] = 148; b[148] = 181;
	  r[149] =   0; g[149] = 149; b[149] = 180;
	  r[150] =   0; g[150] = 150; b[150] = 180;
	  r[151] =   0; g[151] = 151; b[151] = 179;
	  r[152] =   0; g[152] = 152; b[152] = 179;
	  r[153] =   0; g[153] = 153; b[153] = 178;
	  r[154] =   0; g[154] = 154; b[154] = 178;
	  r[155] =   0; g[155] = 155; b[155] = 178;
	  r[156] =   0; g[156] = 156; b[156] = 177;
	  r[157] =   0; g[157] = 157; b[157] = 176;
	  r[158] =   0; g[158] = 158; b[158] = 176;
	  r[159] =   0; g[159] = 159; b[159] = 176;
	  r[160] =   0; g[160] = 160; b[160] = 175;
	  r[161] =   0; g[161] = 161; b[161] = 174;
	  r[162] =   0; g[162] = 162; b[162] = 174;
	  r[163] =   0; g[163] = 163; b[163] = 174;
	  r[164] =   0; g[164] = 164; b[164] = 173;
	  r[165] =   0; g[165] = 165; b[165] = 172;
	  r[166] =   0; g[166] = 166; b[166] = 172;
	  r[167] =   0; g[167] = 167; b[167] = 172;
	  r[168] =   0; g[168] = 168; b[168] = 171;
	  r[169] =   0; g[169] = 169; b[169] = 171;
	  r[170] =   0; g[170] = 170; b[170] = 170;
	  r[171] =   0; g[171] = 171; b[171] = 170;
	  r[172] =   0; g[172] = 172; b[172] = 169;
	  r[173] =   0; g[173] = 173; b[173] = 168;
	  r[174] =   0; g[174] = 174; b[174] = 168;
	  r[175] =   0; g[175] = 175; b[175] = 168;
	  r[176] =   0; g[176] = 176; b[176] = 167;
	  r[177] =   0; g[177] = 177; b[177] = 166;
	  r[178] =   0; g[178] = 178; b[178] = 166;
	  r[179] =   0; g[179] = 179; b[179] = 166;
	  r[180] =   0; g[180] = 180; b[180] = 165;
	  r[181] =   0; g[181] = 181; b[181] = 164;
	  r[182] =   0; g[182] = 182; b[182] = 164;
	  r[183] =   0; g[183] = 183; b[183] = 163;
	  r[184] =   0; g[184] = 184; b[184] = 163;
	  r[185] =   0; g[185] = 185; b[185] = 162;
	  r[186] =   0; g[186] = 186; b[186] = 162;
	  r[187] =   0; g[187] = 187; b[187] = 162;
	  r[188] =   0; g[188] = 188; b[188] = 161;
	  r[189] =   0; g[189] = 189; b[189] = 160;
	  r[190] =   0; g[190] = 190; b[190] = 160;
	  r[191] =   0; g[191] = 191; b[191] = 160;
	  r[192] =   0; g[192] = 192; b[192] = 159;
	  r[193] =   0; g[193] = 193; b[193] = 158;
	  r[194] =   0; g[194] = 194; b[194] = 158;
	  r[195] =   0; g[195] = 195; b[195] = 158;
	  r[196] =   0; g[196] = 196; b[196] = 157;
	  r[197] =   0; g[197] = 197; b[197] = 156;
	  r[198] =   0; g[198] = 198; b[198] = 156;
	  r[199] =   0; g[199] = 199; b[199] = 156;
	  r[200] =   0; g[200] = 200; b[200] = 155;
	  r[201] =   0; g[201] = 201; b[201] = 155;
	  r[202] =   0; g[202] = 202; b[202] = 154;
	  r[203] =   0; g[203] = 203; b[203] = 154;
	  r[204] =   0; g[204] = 204; b[204] = 153;
	  r[205] =   0; g[205] = 205; b[205] = 152;
	  r[206] =   0; g[206] = 206; b[206] = 152;
	  r[207] =   0; g[207] = 207; b[207] = 152;
	  r[208] =   0; g[208] = 208; b[208] = 151;
	  r[209] =   0; g[209] = 209; b[209] = 150;
	  r[210] =   0; g[210] = 210; b[210] = 150;
	  r[211] =   0; g[211] = 211; b[211] = 150;
	  r[212] =   0; g[212] = 212; b[212] = 149;
	  r[213] =   0; g[213] = 213; b[213] = 148;
	  r[214] =   0; g[214] = 214; b[214] = 148;
	  r[215] =   0; g[215] = 215; b[215] = 147;
	  r[216] =   0; g[216] = 216; b[216] = 147;
	  r[217] =   0; g[217] = 217; b[217] = 146;
	  r[218] =   0; g[218] = 218; b[218] = 146;
	  r[219] =   0; g[219] = 219; b[219] = 146;
	  r[220] =   0; g[220] = 220; b[220] = 145;
	  r[221] =   0; g[221] = 221; b[221] = 144;
	  r[222] =   0; g[222] = 222; b[222] = 144;
	  r[223] =   0; g[223] = 223; b[223] = 144;
	  r[224] =   0; g[224] = 224; b[224] = 143;
	  r[225] =   0; g[225] = 225; b[225] = 142;
	  r[226] =   0; g[226] = 226; b[226] = 142;
	  r[227] =   0; g[227] = 227; b[227] = 142;
	  r[228] =   0; g[228] = 228; b[228] = 141;
	  r[229] =   0; g[229] = 229; b[229] = 140;
	  r[230] =   0; g[230] = 230; b[230] = 140;
	  r[231] =   0; g[231] = 231; b[231] = 140;
	  r[232] =   0; g[232] = 232; b[232] = 139;
	  r[233] =   0; g[233] = 233; b[233] = 139;
	  r[234] =   0; g[234] = 234; b[234] = 138;
	  r[235] =   0; g[235] = 235; b[235] = 138;
	  r[236] =   0; g[236] = 236; b[236] = 137;
	  r[237] =   0; g[237] = 237; b[237] = 136;
	  r[238] =   0; g[238] = 238; b[238] = 136;
	  r[239] =   0; g[239] = 239; b[239] = 136;
	  r[240] =   0; g[240] = 240; b[240] = 135;
	  r[241] =   0; g[241] = 241; b[241] = 134;
	  r[242] =   0; g[242] = 242; b[242] = 134;
	  r[243] =   0; g[243] = 243; b[243] = 134;
	  r[244] =   0; g[244] = 244; b[244] = 133;
	  r[245] =   0; g[245] = 245; b[245] = 132;
	  r[246] =   0; g[246] = 246; b[246] = 132;
	  r[247] =   0; g[247] = 247; b[247] = 132;
	  r[248] =   0; g[248] = 248; b[248] = 131;
	  r[249] =   0; g[249] = 249; b[249] = 130;
	  r[250] =   0; g[250] = 250; b[250] = 130;
	  r[251] =   0; g[251] = 251; b[251] = 130;
	  r[252] =   0; g[252] = 252; b[252] = 129;
	  r[253] =   0; g[253] = 253; b[253] = 128;
	  r[254] =   0; g[254] = 254; b[254] = 128;
	  r[255] =   0; g[255] = 255; b[255] = 128;
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_JET)
    {
      /***********************************************************************/

      /***** Jet color palette ***********************************************/

      if (colors == 256)
	{
	  /* Colormap from matlab */

	  r[  0] =   0; g[  0] =   0; b[  0] = 127;
	  r[  1] =   0; g[  1] =   0; b[  1] = 131;
	  r[  2] =   0; g[  2] =   0; b[  2] = 135;
	  r[  3] =   0; g[  3] =   0; b[  3] = 139;
	  r[  4] =   0; g[  4] =   0; b[  4] = 143;
	  r[  5] =   0; g[  5] =   0; b[  5] = 147;
	  r[  6] =   0; g[  6] =   0; b[  6] = 151;
	  r[  7] =   0; g[  7] =   0; b[  7] = 155;
	  r[  8] =   0; g[  8] =   0; b[  8] = 159;
	  r[  9] =   0; g[  9] =   0; b[  9] = 163;
	  r[ 10] =   0; g[ 10] =   0; b[ 10] = 167;
	  r[ 11] =   0; g[ 11] =   0; b[ 11] = 171;
	  r[ 12] =   0; g[ 12] =   0; b[ 12] = 175;
	  r[ 13] =   0; g[ 13] =   0; b[ 13] = 179;
	  r[ 14] =   0; g[ 14] =   0; b[ 14] = 183;
	  r[ 15] =   0; g[ 15] =   0; b[ 15] = 187;
	  r[ 16] =   0; g[ 16] =   0; b[ 16] = 191;
	  r[ 17] =   0; g[ 17] =   0; b[ 17] = 195;
	  r[ 18] =   0; g[ 18] =   0; b[ 18] = 199;
	  r[ 19] =   0; g[ 19] =   0; b[ 19] = 203;
	  r[ 20] =   0; g[ 20] =   0; b[ 20] = 207;
	  r[ 21] =   0; g[ 21] =   0; b[ 21] = 211;
	  r[ 22] =   0; g[ 22] =   0; b[ 22] = 215;
	  r[ 23] =   0; g[ 23] =   0; b[ 23] = 219;
	  r[ 24] =   0; g[ 24] =   0; b[ 24] = 223;
	  r[ 25] =   0; g[ 25] =   0; b[ 25] = 227;
	  r[ 26] =   0; g[ 26] =   0; b[ 26] = 231;
	  r[ 27] =   0; g[ 27] =   0; b[ 27] = 235;
	  r[ 28] =   0; g[ 28] =   0; b[ 28] = 239;
	  r[ 29] =   0; g[ 29] =   0; b[ 29] = 243;
	  r[ 30] =   0; g[ 30] =   0; b[ 30] = 247;
	  r[ 31] =   0; g[ 31] =   0; b[ 31] = 251;
	  r[ 32] =   0; g[ 32] =   0; b[ 32] = 255;
	  r[ 33] =   0; g[ 33] =   4; b[ 33] = 255;
	  r[ 34] =   0; g[ 34] =   8; b[ 34] = 255;
	  r[ 35] =   0; g[ 35] =  12; b[ 35] = 255;
	  r[ 36] =   0; g[ 36] =  16; b[ 36] = 255;
	  r[ 37] =   0; g[ 37] =  20; b[ 37] = 255;
	  r[ 38] =   0; g[ 38] =  24; b[ 38] = 255;
	  r[ 39] =   0; g[ 39] =  28; b[ 39] = 255;
	  r[ 40] =   0; g[ 40] =  32; b[ 40] = 255;
	  r[ 41] =   0; g[ 41] =  36; b[ 41] = 255;
	  r[ 42] =   0; g[ 42] =  40; b[ 42] = 255;
	  r[ 43] =   0; g[ 43] =  44; b[ 43] = 255;
	  r[ 44] =   0; g[ 44] =  48; b[ 44] = 255;
	  r[ 45] =   0; g[ 45] =  52; b[ 45] = 255;
	  r[ 46] =   0; g[ 46] =  56; b[ 46] = 255;
	  r[ 47] =   0; g[ 47] =  60; b[ 47] = 255;
	  r[ 48] =   0; g[ 48] =  64; b[ 48] = 255;
	  r[ 49] =   0; g[ 49] =  68; b[ 49] = 255;
	  r[ 50] =   0; g[ 50] =  72; b[ 50] = 255;
	  r[ 51] =   0; g[ 51] =  76; b[ 51] = 255;
	  r[ 52] =   0; g[ 52] =  80; b[ 52] = 255;
	  r[ 53] =   0; g[ 53] =  84; b[ 53] = 255;
	  r[ 54] =   0; g[ 54] =  88; b[ 54] = 255;
	  r[ 55] =   0; g[ 55] =  92; b[ 55] = 255;
	  r[ 56] =   0; g[ 56] =  96; b[ 56] = 255;
	  r[ 57] =   0; g[ 57] = 100; b[ 57] = 255;
	  r[ 58] =   0; g[ 58] = 104; b[ 58] = 255;
	  r[ 59] =   0; g[ 59] = 108; b[ 59] = 255;
	  r[ 60] =   0; g[ 60] = 112; b[ 60] = 255;
	  r[ 61] =   0; g[ 61] = 116; b[ 61] = 255;
	  r[ 62] =   0; g[ 62] = 120; b[ 62] = 255;
	  r[ 63] =   0; g[ 63] = 124; b[ 63] = 255;
	  r[ 64] =   0; g[ 64] = 128; b[ 64] = 255;
	  r[ 65] =   0; g[ 65] = 132; b[ 65] = 255;
	  r[ 66] =   0; g[ 66] = 136; b[ 66] = 255;
	  r[ 67] =   0; g[ 67] = 140; b[ 67] = 255;
	  r[ 68] =   0; g[ 68] = 144; b[ 68] = 255;
	  r[ 69] =   0; g[ 69] = 148; b[ 69] = 255;
	  r[ 70] =   0; g[ 70] = 152; b[ 70] = 255;
	  r[ 71] =   0; g[ 71] = 156; b[ 71] = 255;
	  r[ 72] =   0; g[ 72] = 160; b[ 72] = 255;
	  r[ 73] =   0; g[ 73] = 164; b[ 73] = 255;
	  r[ 74] =   0; g[ 74] = 168; b[ 74] = 255;
	  r[ 75] =   0; g[ 75] = 172; b[ 75] = 255;
	  r[ 76] =   0; g[ 76] = 176; b[ 76] = 255;
	  r[ 77] =   0; g[ 77] = 180; b[ 77] = 255;
	  r[ 78] =   0; g[ 78] = 184; b[ 78] = 255;
	  r[ 79] =   0; g[ 79] = 188; b[ 79] = 255;
	  r[ 80] =   0; g[ 80] = 192; b[ 80] = 255;
	  r[ 81] =   0; g[ 81] = 196; b[ 81] = 255;
	  r[ 82] =   0; g[ 82] = 200; b[ 82] = 255;
	  r[ 83] =   0; g[ 83] = 204; b[ 83] = 255;
	  r[ 84] =   0; g[ 84] = 208; b[ 84] = 255;
	  r[ 85] =   0; g[ 85] = 212; b[ 85] = 255;
	  r[ 86] =   0; g[ 86] = 216; b[ 86] = 255;
	  r[ 87] =   0; g[ 87] = 220; b[ 87] = 255;
	  r[ 88] =   0; g[ 88] = 224; b[ 88] = 255;
	  r[ 89] =   0; g[ 89] = 228; b[ 89] = 255;
	  r[ 90] =   0; g[ 90] = 232; b[ 90] = 255;
	  r[ 91] =   0; g[ 91] = 236; b[ 91] = 255;
	  r[ 92] =   0; g[ 92] = 240; b[ 92] = 255;
	  r[ 93] =   0; g[ 93] = 244; b[ 93] = 255;
	  r[ 94] =   0; g[ 94] = 248; b[ 94] = 255;
	  r[ 95] =   0; g[ 95] = 252; b[ 95] = 255;
	  r[ 96] =   1; g[ 96] = 255; b[ 96] = 253;
	  r[ 97] =   5; g[ 97] = 255; b[ 97] = 249;
	  r[ 98] =   9; g[ 98] = 255; b[ 98] = 245;
	  r[ 99] =  13; g[ 99] = 255; b[ 99] = 241;
	  r[100] =  17; g[100] = 255; b[100] = 237;
	  r[101] =  21; g[101] = 255; b[101] = 233;
	  r[102] =  25; g[102] = 255; b[102] = 229;
	  r[103] =  29; g[103] = 255; b[103] = 225;
	  r[104] =  33; g[104] = 255; b[104] = 221;
	  r[105] =  37; g[105] = 255; b[105] = 217;
	  r[106] =  41; g[106] = 255; b[106] = 213;
	  r[107] =  45; g[107] = 255; b[107] = 209;
	  r[108] =  49; g[108] = 255; b[108] = 205;
	  r[109] =  53; g[109] = 255; b[109] = 201;
	  r[110] =  57; g[110] = 255; b[110] = 197;
	  r[111] =  61; g[111] = 255; b[111] = 193;
	  r[112] =  65; g[112] = 255; b[112] = 189;
	  r[113] =  69; g[113] = 255; b[113] = 185;
	  r[114] =  73; g[114] = 255; b[114] = 181;
	  r[115] =  77; g[115] = 255; b[115] = 177;
	  r[116] =  81; g[116] = 255; b[116] = 173;
	  r[117] =  85; g[117] = 255; b[117] = 169;
	  r[118] =  89; g[118] = 255; b[118] = 165;
	  r[119] =  93; g[119] = 255; b[119] = 161;
	  r[120] =  97; g[120] = 255; b[120] = 157;
	  r[121] = 101; g[121] = 255; b[121] = 153;
	  r[122] = 105; g[122] = 255; b[122] = 149;
	  r[123] = 109; g[123] = 255; b[123] = 145;
	  r[124] = 113; g[124] = 255; b[124] = 141;
	  r[125] = 117; g[125] = 255; b[125] = 137;
	  r[126] = 121; g[126] = 255; b[126] = 133;
	  r[127] = 125; g[127] = 255; b[127] = 129;
	  r[128] = 129; g[128] = 255; b[128] = 125;
	  r[129] = 133; g[129] = 255; b[129] = 121;
	  r[130] = 137; g[130] = 255; b[130] = 117;
	  r[131] = 141; g[131] = 255; b[131] = 113;
	  r[132] = 145; g[132] = 255; b[132] = 109;
	  r[133] = 149; g[133] = 255; b[133] = 105;
	  r[134] = 153; g[134] = 255; b[134] = 101;
	  r[135] = 157; g[135] = 255; b[135] =  97;
	  r[136] = 161; g[136] = 255; b[136] =  93;
	  r[137] = 165; g[137] = 255; b[137] =  89;
	  r[138] = 169; g[138] = 255; b[138] =  85;
	  r[139] = 173; g[139] = 255; b[139] =  81;
	  r[140] = 177; g[140] = 255; b[140] =  77;
	  r[141] = 181; g[141] = 255; b[141] =  73;
	  r[142] = 185; g[142] = 255; b[142] =  69;
	  r[143] = 189; g[143] = 255; b[143] =  65;
	  r[144] = 193; g[144] = 255; b[144] =  61;
	  r[145] = 197; g[145] = 255; b[145] =  57;
	  r[146] = 201; g[146] = 255; b[146] =  53;
	  r[147] = 205; g[147] = 255; b[147] =  49;
	  r[148] = 209; g[148] = 255; b[148] =  45;
	  r[149] = 213; g[149] = 255; b[149] =  41;
	  r[150] = 217; g[150] = 255; b[150] =  37;
	  r[151] = 221; g[151] = 255; b[151] =  33;
	  r[152] = 225; g[152] = 255; b[152] =  29;
	  r[153] = 229; g[153] = 255; b[153] =  25;
	  r[154] = 233; g[154] = 255; b[154] =  21;
	  r[155] = 237; g[155] = 255; b[155] =  17;
	  r[156] = 241; g[156] = 255; b[156] =  13;
	  r[157] = 245; g[157] = 255; b[157] =   9;
	  r[158] = 249; g[158] = 255; b[158] =   5;
	  r[159] = 253; g[159] = 255; b[159] =   1;
	  r[160] = 255; g[160] = 252; b[160] =   0;
	  r[161] = 255; g[161] = 248; b[161] =   0;
	  r[162] = 255; g[162] = 244; b[162] =   0;
	  r[163] = 255; g[163] = 240; b[163] =   0;
	  r[164] = 255; g[164] = 236; b[164] =   0;
	  r[165] = 255; g[165] = 232; b[165] =   0;
	  r[166] = 255; g[166] = 228; b[166] =   0;
	  r[167] = 255; g[167] = 224; b[167] =   0;
	  r[168] = 255; g[168] = 220; b[168] =   0;
	  r[169] = 255; g[169] = 216; b[169] =   0;
	  r[170] = 255; g[170] = 212; b[170] =   0;
	  r[171] = 255; g[171] = 208; b[171] =   0;
	  r[172] = 255; g[172] = 204; b[172] =   0;
	  r[173] = 255; g[173] = 200; b[173] =   0;
	  r[174] = 255; g[174] = 196; b[174] =   0;
	  r[175] = 255; g[175] = 192; b[175] =   0;
	  r[176] = 255; g[176] = 188; b[176] =   0;
	  r[177] = 255; g[177] = 184; b[177] =   0;
	  r[178] = 255; g[178] = 180; b[178] =   0;
	  r[179] = 255; g[179] = 176; b[179] =   0;
	  r[180] = 255; g[180] = 172; b[180] =   0;
	  r[181] = 255; g[181] = 168; b[181] =   0;
	  r[182] = 255; g[182] = 164; b[182] =   0;
	  r[183] = 255; g[183] = 160; b[183] =   0;
	  r[184] = 255; g[184] = 156; b[184] =   0;
	  r[185] = 255; g[185] = 152; b[185] =   0;
	  r[186] = 255; g[186] = 148; b[186] =   0;
	  r[187] = 255; g[187] = 144; b[187] =   0;
	  r[188] = 255; g[188] = 140; b[188] =   0;
	  r[189] = 255; g[189] = 136; b[189] =   0;
	  r[190] = 255; g[190] = 132; b[190] =   0;
	  r[191] = 255; g[191] = 128; b[191] =   0;
	  r[192] = 255; g[192] = 124; b[192] =   0;
	  r[193] = 255; g[193] = 120; b[193] =   0;
	  r[194] = 255; g[194] = 116; b[194] =   0;
	  r[195] = 255; g[195] = 112; b[195] =   0;
	  r[196] = 255; g[196] = 108; b[196] =   0;
	  r[197] = 255; g[197] = 104; b[197] =   0;
	  r[198] = 255; g[198] = 100; b[198] =   0;
	  r[199] = 255; g[199] =  96; b[199] =   0;
	  r[200] = 255; g[200] =  92; b[200] =   0;
	  r[201] = 255; g[201] =  88; b[201] =   0;
	  r[202] = 255; g[202] =  84; b[202] =   0;
	  r[203] = 255; g[203] =  80; b[203] =   0;
	  r[204] = 255; g[204] =  76; b[204] =   0;
	  r[205] = 255; g[205] =  72; b[205] =   0;
	  r[206] = 255; g[206] =  68; b[206] =   0;
	  r[207] = 255; g[207] =  64; b[207] =   0;
	  r[208] = 255; g[208] =  60; b[208] =   0;
	  r[209] = 255; g[209] =  56; b[209] =   0;
	  r[210] = 255; g[210] =  52; b[210] =   0;
	  r[211] = 255; g[211] =  48; b[211] =   0;
	  r[212] = 255; g[212] =  44; b[212] =   0;
	  r[213] = 255; g[213] =  40; b[213] =   0;
	  r[214] = 255; g[214] =  36; b[214] =   0;
	  r[215] = 255; g[215] =  32; b[215] =   0;
	  r[216] = 255; g[216] =  28; b[216] =   0;
	  r[217] = 255; g[217] =  24; b[217] =   0;
	  r[218] = 255; g[218] =  20; b[218] =   0;
	  r[219] = 255; g[219] =  16; b[219] =   0;
	  r[220] = 255; g[220] =  12; b[220] =   0;
	  r[221] = 255; g[221] =   8; b[221] =   0;
	  r[222] = 255; g[222] =   4; b[222] =   0;
	  r[223] = 255; g[223] =   0; b[223] =   0;
	  r[224] = 251; g[224] =   0; b[224] =   0;
	  r[225] = 247; g[225] =   0; b[225] =   0;
	  r[226] = 243; g[226] =   0; b[226] =   0;
	  r[227] = 239; g[227] =   0; b[227] =   0;
	  r[228] = 235; g[228] =   0; b[228] =   0;
	  r[229] = 231; g[229] =   0; b[229] =   0;
	  r[230] = 227; g[230] =   0; b[230] =   0;
	  r[231] = 223; g[231] =   0; b[231] =   0;
	  r[232] = 219; g[232] =   0; b[232] =   0;
	  r[233] = 215; g[233] =   0; b[233] =   0;
	  r[234] = 211; g[234] =   0; b[234] =   0;
	  r[235] = 207; g[235] =   0; b[235] =   0;
	  r[236] = 203; g[236] =   0; b[236] =   0;
	  r[237] = 199; g[237] =   0; b[237] =   0;
	  r[238] = 195; g[238] =   0; b[238] =   0;
	  r[239] = 191; g[239] =   0; b[239] =   0;
	  r[240] = 187; g[240] =   0; b[240] =   0;
	  r[241] = 183; g[241] =   0; b[241] =   0;
	  r[242] = 179; g[242] =   0; b[242] =   0;
	  r[243] = 175; g[243] =   0; b[243] =   0;
	  r[244] = 171; g[244] =   0; b[244] =   0;
	  r[245] = 167; g[245] =   0; b[245] =   0;
	  r[246] = 163; g[246] =   0; b[246] =   0;
	  r[247] = 159; g[247] =   0; b[247] =   0;
	  r[248] = 155; g[248] =   0; b[248] =   0;
	  r[249] = 151; g[249] =   0; b[249] =   0;
	  r[250] = 147; g[250] =   0; b[250] =   0;
	  r[251] = 143; g[251] =   0; b[251] =   0;
	  r[252] = 139; g[252] =   0; b[252] =   0;
	  r[253] = 135; g[253] =   0; b[253] =   0;
	  r[254] = 131; g[254] =   0; b[254] =   0;
	  r[255] = 127; g[255] =   0; b[255] =   0;
	}
      else
	Die(FUNCTION_NAME, "Mismatch in number of colors");


      /*
	m = 0;

	for (n = 0; n < (long)((double)colors/4.0); n++)
	{
	f1 = ((double)n)/((double)(colors/4.0) - 1.0);

	r[m] = 0;
	g[m] = (long)(f1*255.0);
	b[m] = 255;
	  
	m++;
	}

	for (n = 0; n < (long)((double)colors/4.0); n++)
	{
	f1 = ((double)n)/((double)(colors/4.0) - 1.0);

	r[m] = 0;
	g[m] = 255;
	b[m] = (long)((1.0 - f1)*255.0);

	m++;
	}

	for (n = 0; n < (long)((double)colors/4.0); n++)
	{
	f1 = ((double)n)/((double)(colors/4.0) - 1.0);

	r[m] = (long)(f1*255.0);
	g[m] = 255;
	b[m] = 0;

	m++;
	}

	for (n = 0; n < (long)((double)colors/4.0); n++)
	{
	f1 = ((double)n)/((double)(colors/4.0) - 1.0);

	r[m] = 255;
	g[m] = (long)((1.0 - f1)*255.0);
	b[m] = 0;

	m++;
	}
      */
      /* Loop over colors */

#ifdef mmmmmmmmmm

      for (n = 0; n < colors; n++)
	{
	  /* Linear factor */

	  f1 = ((double)n)/((double)colors - 1.0);

	  /* Red */

	  if (f1 <= 0.375)
	    f2 = 0.0;
	  else if (f1 <= 0.6250)
	    f2 = (f1 - 0.3750)/(0.6250 - 0.3750);
	  else if (f1 <= 0.8750)
	    f2 = 1.0;
	  else
	    f2 = 1.0 - (f1 - 0.8750)/(1.0 - 0.8750)*0.5;

	  f2 = (1.0 - cos(f2*PI))/2.0;
	  r[n] = (long)(255.0*f2);

	  /* Green */

	  if (f1 <= 0.1250)
	    f2 = 0.0;
	  else if (f1 <= 0.3750)
	    f2 = (f1 - 0.1250)/(0.3750 - 0.1250);
	  else if (f1 <= 0.6250)
	    f2 = 1.0;
	  else if (f1 <= 0.8750)
	    f2 = 1.0 - (f1 - 0.6250)/(0.8750 - 0.6250);
	  else 
	    f2 = 0.0;

	  f2 = (1.0 - cos(f2*PI))/2.0;
	  g[n] = (long)(255.0*f2);

	  /* Blue */

	  if (f1 <= 0.1250)
	    f2 = 0.5*f1/0.1250 + 0.5;
	  else if (f1 <= 0.3750)
	    f2 = 1.0;
	  else if (f1 <= 0.6250)
	    f2 = 1.0 - (f1 - 0.3750)/(0.6250 - 0.3750);
	  else 
	    f2 = 0.0;

	  f2 = (1.0 - cos(f2*PI))/2.0;
	  b[n] = (long)(255.0*f2);

#ifdef mmm

	  /* Linear factor */

	  f1 = ((double)n)/((double)colors - 1.0);

	  /* Red */

	  if (f1 <= 0.375)
	    f2 = 0.0;
	  else if (f1 <= 0.6250)
	    f2 = (f1 - 0.3750)/(0.6250 - 0.3750);
	  else if (f1 <= 0.8750)
	    f2 = 1.0;
	  else
	    f2 = 1.0 - (f1 - 0.8750)/(1.0 - 0.8750)*0.5;

	  r[n] = (long)(255.0*f2);

	  /* Green */

	  if (f1 <= 0.1250)
	    f2 = 0.0;
	  else if (f1 <= 0.3750)
	    f2 = (f1 - 0.1250)/(0.3750 - 0.1250);
	  else if (f1 <= 0.6250)
	    f2 = 1.0;
	  else if (f1 <= 0.8750)
	    f2 = 1.0 - (f1 - 0.6250)/(0.8750 - 0.6250);
	  else 
	    f2 = 0.0;

	  g[n] = (long)(255.0*f2);

	  /* Blue */

	  if (f1 <= 0.1250)
	    f2 = 0.5*f1/0.1250 + 0.5;
	  else if (f1 <= 0.3750)
	    f2 = 1.0;
	  else if (f1 <= 0.6250)
	    f2 = 1.0 - (f1 - 0.3750)/(0.6250 - 0.3750);
	  else 
	    f2 = 0.0;

	  b[n] = (long)(255.0*f2);

#endif

	}

#endif


      /***********************************************************************/
    }
  else if (type == PALETTE_BW)
    {
      /***********************************************************************/

      /***** Cold color palette **********************************************/

      /* Loop over colors */

      for (n = 0; n < colors; n++)
	{
	  /* Linear factor */

	  f1 = ((double)n)/((double)colors - 1.0);
	  
	  /* Put values */
	  
	  r[n] = (long)(255.0*f1);
	  g[n] = (long)(255.0*f1);
	  b[n] = (long)(255.0*f1);
	}

      /***********************************************************************/
    }
  else if (type == PALETTE_HOTCOLD)
    {
      /***********************************************************************/

      /***** Combined hot / cold palette *************************************/

      /* Number of colors */

      colors = (long)((double)colors/2.0);
      
      /* Make cold palette */
      
      MakePalette(r, g, b, colors, PALETTE_COLD);

      /* Make hot palette */
    
      MakePalette(&r[colors], &g[colors], &b[colors], colors, PALETTE_HOT);
      
      /***********************************************************************/
    }
  else
    Die(FUNCTION_NAME, "Invalid palette type");
}

/*****************************************************************************/
